<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Frank</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="è®¡ç®—æœº ç½‘ç»œ äº’è”ç½‘">
<meta property="og:type" content="website">
<meta property="og:title" content="Frank">
<meta property="og:url" content="http://www.notehub.cn/page/2/index.html">
<meta property="og:site_name" content="Frank">
<meta property="og:description" content="è®¡ç®—æœº ç½‘ç»œ äº’è”ç½‘">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Frank">
<meta name="twitter:description" content="è®¡ç®—æœº ç½‘ç»œ äº’è”ç½‘">
  
  
    <link rel="icon" href="favicon.png">
  
  <link href='//fonts.css.network/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  <link href="//fonts.css.network/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  

  
</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.jpg)"></i><span class="site-title">Frank</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/logo.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://www.notehub.cn"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/categories">Categories</a></td>
        
          <td><a class="main-nav-link" href="/tags">Tags</a></td>
        
          <td><a class="main-nav-link" href="/about">About</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://www.notehub.cn"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="/css/images/logo.png">
      <h2 id="name">Li Jingpeng</h2>
      <!-- <h3 id="title">undefined</h3> -->
      <span id="location"><i class="fa fa-map-marker"></i>Hangzhou, China</span>
      <a id="follow" href="Https://weibo.com/329299516">å…³æ³¨æˆ‘</a>
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        107
        <span>æ–‡ç« </span>
      </div>
      <div class="article-info-block">
        42
        <span>æ ‡ç­¾</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="https://github.com/lijingpeng" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="#" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="#" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
          
          <td><a href="/me@lijingpeng.org" target="_blank" title="email"><i class="fa fa-email"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
        </tr>
      </table>
    </div>
    
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-other/public_cdn" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/11/other/public_cdn/">CDNJS åº“ä»¥åŠ Google Fontsã€Ajax å’Œ Gravatar åä»£</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/09/11/other/public_cdn/">
      <time datetime="2016-09-10T16:00:00.000Z" itemprop="datePublished">2016-09-11</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/other/">other</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>ç”±äºæŸäº›ä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œå¥½å¤šå¼€æºçš„ JS åº“é‡‡ç”¨çš„å›½å¤– CDN æ‰˜ç®¡æ–¹å¼åœ¨å›½å†…è®¿é—®é€Ÿåº¦ä¸å¦‚äººæ„ã€‚æ‰€ä»¥æˆ‘ä»¬ç‰¹æ„åˆ¶ä½œäº†è¿™ä¸ªå…¬ç›Šé¡¹ç›®ï¼Œæ‰˜ç®¡äº† CDNJS çš„æ‰€æœ‰å¼€æº JS åº“ä»¥åŠåä»£äº† Google Fontsã€Ajax å’Œ Gravatarï¼Œå¹¶ä¸”å…¨éƒ¨æ”¯æŒ http å’Œ https</p>
<h2 id="u4E00_u3001CDNJS__u5F00_u6E90_JS__u5E93"><a href="#u4E00_u3001CDNJS__u5F00_u6E90_JS__u5E93" class="headerlink" title="ä¸€ã€CDNJS å¼€æº JS åº“"></a>ä¸€ã€CDNJS å¼€æº JS åº“</h2><p>æˆ‘ä»¬é‡‡ç”¨çš„æ–¹æ³•æ˜¯æ¯å¤©å®šæ—¶åŒæ­¥ CDNJS çš„ Github</p>
<p>æ‰€æœ‰çš„ JS åº“å¯ä»¥åœ¨è¿™å„¿æ‰¾åˆ°æ‚¨éœ€è¦çš„é“¾æ¥</p>
<p><a href="http://cdn.css.net/libs/" target="_blank" rel="external">http://cdn.css.net/libs/</a></p>
<p>å¹¶ä¸”æ”¯æŒ https ï¼Œæ¯”å¦‚</p>
<p><a href="http://cdn.css.net/libs/jquery/2.1.4/jquery.min.js" target="_blank" rel="external">http://cdn.css.net/libs/jquery/2.1.4/jquery.min.js</a><br><a href="https://cdn.css.net/libs/jquery/2.1.4/jquery.min.js" target="_blank" rel="external">https://cdn.css.net/libs/jquery/2.1.4/jquery.min.js</a></p>
<h2 id="u4E8C_u3001Google_Fonts"><a href="#u4E8C_u3001Google_Fonts" class="headerlink" title="äºŒã€Google Fonts"></a>äºŒã€Google Fonts</h2><p>æˆ‘ä»¬é‡‡ç”¨çš„æ–¹æ³•æ˜¯ä¸‡èƒ½çš„ Nginx åä»£ + å…³é”®è¯æ›¿æ¢ï¼Œå…·ä½“æ–¹æ³•å¯ä»¥æ‘¸è¿™å„¿ã€‚</p>
<p>ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‚¨åªéœ€è¦æ›¿æ¢ fonts.googleapis.com ä¸º fonts.css.network å³å¯ï¼Œå¦‚</p>
<p><link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet"><br>æ›¿æ¢æˆ</p>
<p><link href="//fonts.css.network/css?family=Open+Sans" rel="stylesheet"><br>å¦‚æœéœ€è¦ Material icons ï¼Œåˆ™æŠŠ</p>
<p><a href="https://fonts.googleapis.com/icon?family=Material+Icons" target="_blank" rel="external">https://fonts.googleapis.com/icon?family=Material+Icons</a><br>æ›¿æ¢æˆ</p>
<p><a href="https://fonts.css.network/icon?family=Material+Icons" target="_blank" rel="external">https://fonts.css.network/icon?family=Material+Icons</a><br>å³å¯</p>
<h2 id="u4E09_u3001Google__u524D_u7AEF_u516C_u5171_u5E93"><a href="#u4E09_u3001Google__u524D_u7AEF_u516C_u5171_u5E93" class="headerlink" title="ä¸‰ã€Google å‰ç«¯å…¬å…±åº“"></a>ä¸‰ã€Google å‰ç«¯å…¬å…±åº“</h2><p>æ–¹æ³•åŒä¸Šï¼Œç›´æ¥æ›¿æ¢ ajax.googleapis.com ä¸º ajax.css.network å³å¯ï¼Œå¦‚</p>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
æ›¿æ¢æˆ

<script type="text/javascript" src="//ajax.css.network/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<h2 id="u56DB_u3001Gravatar__u53CD_u4EE3"><a href="#u56DB_u3001Gravatar__u53CD_u4EE3" class="headerlink" title="å››ã€Gravatar åä»£"></a>å››ã€Gravatar åä»£</h2><p>æ–¹æ³•è¿˜æ˜¯åŒä¸Šï¼Œç›´æ¥æ›¿æ¢ *.gravatar.com ä¸º gravatar.css.network å³å¯ï¼Œå¦‚</p>
<p><a href="https://cn.gravatar.com/avatar/8406d089bc81b664a2610b8d214c1428" target="_blank" rel="external">https://cn.gravatar.com/avatar/8406d089bc81b664a2610b8d214c1428</a><br>æ›¿æ¢æˆ</p>
<p><a href="https://gravatar.css.network/avatar/8406d089bc81b664a2610b8d214c1428" target="_blank" rel="external">https://gravatar.css.network/avatar/8406d089bc81b664a2610b8d214c1428</a></p>
<p>From: <a href="https://ttt.tt/185/" target="_blank" rel="external">https://ttt.tt/185/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/09/11/other/public_cdn/" data-id="ciucofbvt00181fjhg61f0mzr" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/09/11/other/public_cdn/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
    </footer>
  </div>
  
</article>



    
      <article id="post-algo/kaggle/gbid" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/09/algo/kaggle/gbid/">kaggleä¹‹Grupo Bimbo Inventory Demand</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/09/09/algo/kaggle/gbid/">
      <time datetime="2016-09-09T05:48:13.000Z" itemprop="datePublished">2016-09-09</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/kaggle/">kaggle</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <h2 id="Grupo_Bimbo_Inventory_Demand"><a href="#Grupo_Bimbo_Inventory_Demand" class="headerlink" title="Grupo Bimbo Inventory Demand"></a>Grupo Bimbo Inventory Demand</h2><p><a href="https://github.com/lijingpeng/kaggle" target="_blank" rel="external">kaggleæ¯”èµ›è§£å†³æ–¹æ¡ˆé›†åˆ</a></p>
<p><a href="https://www.kaggle.com/c/grupo-bimbo-inventory-demand" target="_blank" rel="external">Grupo Bimbo Inventory Demand</a> åœ¨è¿™ä¸ªæ¯”èµ›ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é¢„æµ‹æŸä¸ªäº§å“åœ¨æŸä¸ªé”€å”®ç‚¹æ¯å‘¨çš„éœ€æ±‚é‡ã€‚æ•°æ®åŒ…å«å¢¨è¥¿å“¥9å‘¨çš„é”€å”®æ•°æ®ã€‚æ¯å‘¨ï¼Œè´§è¿è½¦è¾†æŠŠäº§å“å‘å¾€é”€å”®ç‚¹ï¼Œæ¯ç¬”äº¤æ˜“åŒ…å«é”€å”®é‡å’Œé€€è´§é‡ï¼Œå…¶ä¸­é€€è´§é‡ä¸»è¦ç”±æœªé”€å”®å‡ºçš„å’Œè¿‡æœŸçš„äº§å“ç»„æˆã€‚æ¯ä¸ªäº§å“çš„éœ€æ±‚é‡æ˜¯æŒ‡è¯¥å•†å“è¿™å‘¨çš„é”€å”®é‡å‡å»ä¸‹å‘¨çš„é€€è´§é‡ã€‚</p>
<p>å‡ ç‚¹æ³¨æ„ï¼š</p>
<ol>
<li><p>æµ‹è¯•æ•°æ®ä¸­å¯èƒ½åŒ…å«è®­ç»ƒæ•°æ®ä¸­ä¸å­˜åœ¨çš„å•†å“ã€‚è¿™åœ¨å®é™…çš„ç”Ÿæ´»ä¸­æ˜¯ååˆ†å¸¸è§çš„ã€‚æ‰€ä»¥æ¨¡å‹å¿…é¡»å¾ˆå¥½çš„é€‚åº”è¿™ä¸€ç‚¹ã€‚  </p>
</li>
<li><p>åŒä¸€ä¸ªå®¢æˆ·idå¯èƒ½å«æœ‰ä¸åŒçš„å®¢æˆ·åå­—ï¼Œå› ä¸ºå®¢æˆ·åå¹¶æ²¡æœ‰å½’ä¸€åŒ–  </p>
</li>
<li><p>éœ€æ±‚é‡æ˜¯ä¸€ä¸ªå¤§äºç­‰äºé›¶çš„å€¼ï¼ŒVenta_uni_hoy - Dev_uni_proximaæœ‰æ—¶å€™ä¸ºè´Ÿæ˜¯å› ä¸ºæœ‰æ—¶å€™é€€è´§é‡æœ‰æ—¶å€™ç´¯è®¡äº†å¥½å‡ æ˜ŸæœŸã€‚  </p>
</li>
</ol>
<pre><code>Semana â€” Week number (From Thursday to Wednesday) - æ˜ŸæœŸå‡ 
Agencia_ID â€” Sales Depot ID - é”€å”®åœ°id
Canal_ID â€” Sales Channel ID - é”€å”®æ¸ é“id
Ruta_SAK â€” Route ID (Several routes = Sales Depot)
Cliente_ID â€” Client ID - å®¢æˆ·id
NombreCliente â€” Client name - å®¢æˆ·å
Producto_ID â€” Product ID - äº§å“id
NombreProducto â€” Product Name - äº§å“å
Venta_uni_hoy â€” Sales unit this week (integer) - æœ¬å‘¨é”€é‡
Venta_hoy â€” Sales this week (unit: pesos) - æœ¬å‘¨é”€å”®é¢
Dev_uni_proxima â€” Returns unit next week (integer) - é€€è´§é‡
Dev_proxima â€” Returns next week (unit: pesos) - é€€è´§é”€å”®é¢
Demanda_uni_equil â€” Adjusted Demand (integer) (This is the target you will predict) - éœ€æ±‚é‡ï¼ˆç›®æ ‡å€¼ï¼‰
</code></pre><p>é”€é‡é¢„æµ‹æ˜¯ä¸€ä¸ªéå¸¸æœ‰æ„ä¹‰çš„é—®é¢˜ï¼Œåœ¨å®é™…åº”ç”¨ä¸­æœ‰å¤šç§åº”ç”¨ä»·å€¼ï¼Œä¾‹å¦‚å¿«é€’çš„å‘è´§é‡é¢„æµ‹ã€è¿è¾“è§„åˆ’ç­‰ç­‰ã€‚ç²—çœ‹èµ·æ¥ï¼Œè¿™ä¸ªé—®é¢˜å¾ˆåƒä¸€ä¸ªæ—¶é—´åºåˆ—çš„é¢„æµ‹é—®é¢˜ï¼Œä½†æ˜¯é”€å”®åœ°ã€äººã€ç±»ç›®çš„ç»„åˆå¤ªå¤šï¼Œæ—¶é—´ç´¯ç§¯å¤ªçŸ­ï¼Œå› æ­¤ä¸è¶³ä»¥æ”¯æ’‘æ—¶é—´åºåˆ—é¢„æµ‹ã€‚å› æ­¤æˆ‘ä»¬æŠŠä»–ä½œä¸ºä¸€ä¸ªå›å½’é—®é¢˜æ¥è¿›è¡Œåˆ†æã€‚å¾ˆé—æ†¾çš„æ˜¯æ•°æ®é‡å·¨å¤§ï¼Œè§£å‹ç¼©åè®­ç»ƒé›†æœ‰7000ä¸‡+æ•°æ®ï¼Œå¯¹äºæˆ‘çš„å°ç ´æœ¬æ¥è¯´å·²ç»æ— æ³•æ”¯æ’‘è·‘è¿™ä¹ˆå¤§æ•°æ®é›†çš„æœºå™¨å­¦ä¹ ä»»åŠ¡äº†ã€‚åœ¨Kaggleä¸­æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªä½¿ç”¨XGBoostçš„è§£å†³æ–¹æ¡ˆï¼Œä¸‹é¢æ¥ç®€å•ä»‹ç»ä¸€ä¸‹æ€è·¯å’Œä»£ç ã€‚ä¸€äº›å…³é”®ä»£ç çš„æ³¨é‡Šæˆ‘ç¿»è¯‘ä¸ºä¸­æ–‡äº†ã€‚</p>
<p>ç‰¹å¾å·¥ç¨‹çš„åŸºæœ¬æ€è·¯ï¼š</p>
<p>è®¡ç®—ç¬¬ä¸‰å‘¨çš„ç»Ÿè®¡ç‰¹å¾ç”¨æ¥é¢„æµ‹ç¬¬å››å‘¨çš„éœ€æ±‚ã€è®¡ç®—ç¬¬å››å‘¨çš„ç»Ÿè®¡ç‰¹å¾ç”¨æ¥é¢„æµ‹ç¬¬äº”å‘¨çš„éœ€æ±‚â€¦</p>
<pre><code class="python"># A Python implementation of the awesome script by Bohdan Pavlyshenko: http://tinyurl.com/jd6k2kr
# and with inspiration from Rodolfo Lomascolo&#39;s  http://tinyurl.com/z6qmxfk
#
# Author: willgraf
import numpy as np
import pandas as pd
import xgboost as xgb
import pdb

from sklearn.metrics import mean_squared_error
from sklearn.cross_validation import train_test_split

from subprocess import check_output

## --------------------------å…¨å±€å˜é‡-----------------------------------------
#
LAG_WEEK_VAL = 3 # set to 3 to use lagged features.
BIG_LAG = True # set to True if to use more than 1 lagged_featc
## --------------------------å‡½æ•°-----------------------------------------

def get_dataframe():
    &#39;&#39;&#39;
    è½½å…¥è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¯¹äºè®­ç»ƒé›†æˆ‘ä»¬è®¾ç½®ç›®æ ‡ä¸ºã€Demanda_uni_equilã€åˆ—ï¼Œæµ‹è¯•é›†ç›®æ ‡åˆ—æš‚è®¾å®šä¸º0.
    è¿™é‡Œæœ‰ä¸€ä¸ªå…¨å±€å˜é‡LAG_WEEK_VALï¼Œè¡¨ç¤ºweekå¤§äºLAG_WEEK_VALçš„æ•°æ®ä½œä¸ºè®­ç»ƒé›†ï¼ˆè®­ç»ƒé›†ä¸­åªæœ‰ç¬¬ä¸‰å‘¨åˆ°ç¬¬9å‘¨çš„æ•°æ®ï¼Œç›®æ ‡æ˜¯é¢„æµ‹ç¬¬10å’Œ11å‘¨çš„æ•°æ®ï¼‰
    &#39;&#39;&#39;
    print(&#39;Loading training data&#39;)
    train = pd.read_csv(&#39;train.csv&#39;,
                        usecols=[&#39;Semana&#39;,&#39;Agencia_ID&#39;,&#39;Ruta_SAK&#39;,&#39;Cliente_ID&#39;,&#39;Producto_ID&#39;,&#39;Demanda_uni_equil&#39;])

    print(&#39;Loading test data&#39;)
    test = pd.read_csv(&#39;test.csv&#39;,
                       usecols=[&#39;Semana&#39;,&#39;Agencia_ID&#39;,&#39;Ruta_SAK&#39;,&#39;Cliente_ID&#39;,&#39;Producto_ID&#39;,&#39;id&#39;])

    print(&#39;Merging train &amp; test data&#39;)
    # lagged week features
    train = train.loc[train[&#39;Semana&#39;] &gt; LAG_WEEK_VAL,]
    train[&#39;id&#39;] = 0
    test[&#39;Demanda_uni_equil&#39;] = None
    train[&#39;target&#39;] = train[&#39;Demanda_uni_equil&#39;]
    test[&#39;target&#39;] = 0
    # å°†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ç»“åˆåˆ°ä¸€èµ·
    return pd.concat([train, test])

def create_lagged_feats(data, num_lag):
    &#39;&#39;&#39;
    æ„å»ºæ»åçš„é”€é‡ç‰¹å¾ã€‚å³ä½¿ç”¨3~8å‘¨çš„é”€å”®æ•°æ®æ„é€ ç‰¹å¾ï¼Œä¸ºæ¥ä¸‹æ¥9ã€10ã€11å‘¨çš„é¢„æµ‹åšå‡†å¤‡ã€‚
    ä¸¾ä¾‹æ¥è¯´ï¼Œç¬¬ä¸‰å‘¨çš„é”€å”®æ•°æ®ç»Ÿè®¡ç‰¹å¾ä½œä¸ºç¬¬å››å‘¨é”€é‡å½±å“å› å­
    ç‰¹å¾åˆ—åå‘½åä¸º: target_lNUMBER
    &#39;&#39;&#39;
    # æ ¹æ®è¿™ä¸‰åˆ—ç”Ÿæˆç‰¹å¾
    keys = [&#39;Semana&#39;, &#39;Cliente_ID&#39;, &#39;Producto_ID&#39;]
    lag_feat = &#39;target_l&#39; + str(num_lag)
    print(&#39;Creating lagged feature: %s&#39; % lag_feat)
    data1 = df.loc[: , [&#39;Cliente_ID&#39;, &#39;Producto_ID&#39;]]
    # å¯¹weekæ•°åŠ 1ï¼Œä¸ºæ¥ä¸‹æ¥çš„joinåšå‡†å¤‡
    data1[&#39;Semana&#39;] = df.loc[: , &#39;Semana&#39;].apply(lambda x: x + 1)
    # æ‹·è´è®­ç»ƒé›†ä¸­çš„ç›®æ ‡åˆ—ï¼Œå¹¶å‘½åä¸ºtarget_lNUMBERï¼Œä¸ºäº†æ¥ä¸‹æ¥æ±‚å¹³å‡å€¼åšå‡†å¤‡
    data1[lag_feat] = df.loc[: , &#39;target&#39;]
    # groupby &#39;Semana&#39;, &#39;Cliente_ID&#39;, &#39;Producto_ID&#39;å¹¶æ±‚targetåˆ—çš„å¹³å‡å€¼
    data1 = pd.groupby(data1, keys).mean().reset_index()
    # JOINï¼šæŠŠå¹³å‡å€¼çš„ç»Ÿè®¡ç‰¹å¾joinåˆ°dataä¸­
    return pd.merge(data, data1, how=&#39;left&#39;, on=keys, left_index=False, right_index=False,
                    suffixes=(&#39;&#39;, &#39;_lag&#39; + str(num_lag)), copy=False)

def create_freq_feats(data, column_name):
    &#39;&#39;&#39;
    æ±‚åˆ—çš„é¢‘ç‡ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯æ±‚å¯¹åº”åˆ—æ¯å‘¨çš„å¹³å‡å€¼
    &#39;&#39;&#39;
    freq_feat = column_name + &#39;_freq&#39;
    print(&#39;Creating frequency feature: %s&#39; % freq_feat)
    # åˆ—+å‘¨çš„targetè®¡æ•°
    freq_frame = pd.groupby(data, [column_name, &#39;Semana&#39;])[&#39;target&#39;].count().reset_index()
    freq_frame.rename(columns={&#39;target&#39;: freq_feat}, inplace=True)
    # è®¡ç®—å¹³å‡å€¼
    freq_frame = pd.groupby(freq_frame, [column_name])[freq_feat].mean().reset_index()

    # å°†å¹³å‡å€¼joinå›åŸæ¥çš„dataä¸­
    return pd.merge(data, freq_frame, how=&#39;left&#39;, on=[column_name], left_index=False,
                    right_index=False, suffixes=(&#39;&#39;, &#39;_freq&#39;), copy=False)

def build_model(df, features, model_params):
    &#39;&#39;&#39;
    æ„å»ºæ¨¡å‹è®­ç»ƒå’Œæµ‹è¯•
      df: dataframe to be modled - ç”¨æ¥è®­ç»ƒå’Œæµ‹è¯•çš„æ•°æ®
      features: column names of df that should be used in model - ç‰¹å¾åˆ—
      params: {xgb_param_key: &#39;xgb_param_value&#39;} - å‚æ•°
    &#39;&#39;&#39;
    mask = df[&#39;Demanda_uni_equil&#39;].isnull()
    test = df[mask]
    train = df[~mask]
    train.loc[: , &#39;target&#39;] = train.loc[: , &#39;target&#39;].apply(lambda x: np.log(x + 1))

    xlf = xgb.XGBRegressor(**model_params)

    x_train, x_test, y_train, y_test = train_test_split(train[features], train[&#39;target&#39;], test_size=0.01, random_state=1)

    xlf.fit(x_train, y_train, eval_metric=&#39;rmse&#39;, verbose=1, eval_set=[(x_test, y_test)], early_stopping_rounds=100)
    preds = xlf.predict(x_test)
    print(&#39;RMSE of log(Demanda_uni_equil[x_test]) : %s&quot; &#39; % str(mean_squared_error(y_test,preds) ** 0.5))

    # é¢„æµ‹ç¬¬10å‘¨çš„é”€é‡
    print(&#39;Predicting Demanda_uni_equil for Semana 10&#39;)
    data_test_10 = test.loc[test[&#39;Semana&#39;] == 10, features]
    preds = xlf.predict(data_test_10)
    data_test_10[&#39;Demanda_uni_equil&#39;] = np.exp(preds) - 1
    data_test_10[&#39;id&#39;] = test.loc[test[&#39;Semana&#39;] == 10, &#39;id&#39;].astype(int).tolist()

    # æŠŠé¢„æµ‹çš„ç¬¬10å‘¨çš„é”€é‡ç»“æœä½œä¸ºç‰¹å¾æ¥é¢„æµ‹11å‘¨çš„æ•°æ®
    print(&#39;Creating lagged demand feature for Semana 11&#39;)
    data_test_lag = data_test_10[[&#39;Cliente_ID&#39;, &#39;Producto_ID&#39;]]
    data_test_lag[&#39;target_l1&#39;] = data_test_10[&#39;Demanda_uni_equil&#39;]
    data_test_lag = pd.groupby(data_test_lag,[&#39;Cliente_ID&#39;,&#39;Producto_ID&#39;]).mean().reset_index()

    # é¢„æµ‹ç¬¬11å‘¨çš„é”€é‡
    print(&#39;Predicting Demanda_uni_equil for Semana 11&#39;)
    data_test_11 = test.loc[test[&#39;Semana&#39;] == 11, features.difference([&#39;target_l1&#39;])]
    data_test_11 = pd.merge(data_test_11, data_test_lag, how=&#39;left&#39;, on=[&#39;Cliente_ID&#39;, &#39;Producto_ID&#39;],
                            left_index=False, right_index=False, sort=True, copy=False)

    data_test_11 = data_test_11.loc[: , features]#.replace(np.nan, 0, inplace=True)
    preds = xlf.predict(data_test_11)
    data_test_11[&#39;Demanda_uni_equil&#39;] = np.exp(preds) - 1
    data_test_11[&#39;id&#39;] = test.loc[test[&#39;Semana&#39;] == 11, &#39;id&#39;].astype(int).tolist()

    return pd.concat([data_test_10.loc[: , [&#39;id&#39;, &#39;Demanda_uni_equil&#39;]],
                      data_test_11.loc[: , [&#39;id&#39;, &#39;Demanda_uni_equil&#39;]]],
                      axis=0, copy=True)

## --------------------------æ‰§è¡Œ-----------------------------------------

## é¦–å…ˆè½½å…¥è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¹¶è¿›è¡ŒåŸºæœ¬çš„æ•°æ®é¢„å¤„ç†
df = get_dataframe()

## æ„å»ºç‰¹å¾
for i in range(1, 1 + 5):
    if not BIG_LAG and i &gt; 1:
        break
    df = create_lagged_feats(df, num_lag=i)

df = df[df[&#39;Semana&#39;] &gt; 8]

## è®¡ç®—åˆ—é¢‘ç‡ç‰¹å¾
for col_name in [&#39;Agencia_ID&#39;, &#39;Ruta_SAK&#39;, &#39;Cliente_ID&#39;, &#39;Producto_ID&#39;]:
    df = create_freq_feats(df, col_name)

## é€‰æ‹©éƒ¨åˆ†ç‰¹å¾æ¥æ„å»ºæ¨¡å‹
feature_names = df.columns.difference([&#39;id&#39;, &#39;target&#39;, &#39;Demanda_uni_equil&#39;])
print(&#39;Data Cleaned.  Using features: %s&#39; % feature_names)

## æ¨¡å‹å‚æ•°
xgb_params = {
    &#39;max_depth&#39;: 10,
    &#39;learning_rate&#39;: 0.01,
    &#39;n_estimators&#39;: 75,
    &#39;subsample&#39;: .85,
    &#39;colsample_bytree&#39;: 0.7,
    &#39;objective&#39;: &#39;reg:linear&#39;,
    &#39;silent&#39;: True,
    &#39;nthread&#39;: -1,
    &#39;gamma&#39;: 0,
    &#39;min_child_weight&#39;: 1,
    &#39;max_delta_step&#39;: 0,
    &#39;subsample&#39;: 0.85,
    &#39;colsample_bytree&#39;: 0.7,
    &#39;colsample_bylevel&#39;: 1,
    &#39;reg_alpha&#39;: 0,
    &#39;reg_lambda&#39;: 1,
    &#39;scale_pos_weight&#39;: 1,
    &#39;missing&#39;: None,
    &#39;seed&#39;: 1
}

## è®­ç»ƒæ¨¡å‹å¹¶å†™å…¥ç»“æœ
submission = build_model(df, feature_names, xgb_params)
submission.to_csv(&#39;submission.csv&#39;, index=False)
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/09/09/algo/kaggle/gbid/" data-id="ciucofbxs003x1fjh1pclatkm" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/09/09/algo/kaggle/gbid/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kaggle/">kaggle</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-dev/python/pandas_reset_index" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/08/dev/python/pandas_reset_index/">pandas reset_index</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/09/08/dev/python/pandas_reset_index/">
      <time datetime="2016-09-08T02:19:56.000Z" itemprop="datePublished">2016-09-08</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/dev/">dev</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <pre><code class="python">df1 = pandas.DataFrame( {
    &quot;Name&quot; : [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Mallory&quot;, &quot;Mallory&quot;, &quot;Bob&quot; , &quot;Mallory&quot;] ,
    &quot;City&quot; : [&quot;Seattle&quot;, &quot;Seattle&quot;, &quot;Portland&quot;, &quot;Seattle&quot;, &quot;Seattle&quot;, &quot;Portland&quot;] } )
</code></pre>
<pre><code class="python">g1.add_suffix(&#39;_Count&#39;).reset_index()
</code></pre>
<pre><code class="python">Out[21]:
      Name      City  City_Count  Name_Count
0    Alice   Seattle           1           1
1      Bob   Seattle           2           2
2  Mallory  Portland           2           2
3  Mallory   Seattle           1           1
</code></pre>
<pre><code class="python">DataFrame({&#39;count&#39; : df1.groupby( [ &quot;Name&quot;, &quot;City&quot;] ).size()}).reset_index()
</code></pre>
<pre><code>      Name      City  count
0    Alice   Seattle      1
1      Bob   Seattle      2
2  Mallory  Portland      2
3  Mallory   Seattle      1
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/09/08/dev/python/pandas_reset_index/" data-id="ciucofbyp006t1fjhcjiip11a" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/09/08/dev/python/pandas_reset_index/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-dev/python/python_print_chs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/31/dev/python/python_print_chs/">Python print ä¸­æ–‡ä¹±ç é—®é¢˜</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/08/31/dev/python/python_print_chs/">
      <time datetime="2016-08-31T02:19:56.000Z" itemprop="datePublished">2016-08-31</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/dev/">dev</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <pre><code class="python">#!/usr/bin/env python
# -*- coding: UTF-8 -*-
import sys
reload(sys)
sys.setdefaultencoding(&#39;utf-8&#39;)

file = open(&#39;~/file.csv&#39;)
lines = file.readlines()
for line in lines:
    print line.decode(&#39;gbk&#39;)
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/08/31/dev/python/python_print_chs/" data-id="ciucofbys00711fjh16v3plu9" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/08/31/dev/python/python_print_chs/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-algo/kaggle/facial_keypoints" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/26/algo/kaggle/facial_keypoints/">kaggleä¹‹äººè„¸ç‰¹å¾è¯†åˆ«</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/08/26/algo/kaggle/facial_keypoints/">
      <time datetime="2016-08-26T05:48:13.000Z" itemprop="datePublished">2016-08-26</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/kaggle/">kaggle</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p><a href="https://github.com/lijingpeng/kaggle/tree/master/competitions/Facial_Keypoints_Detection" target="_blank" rel="external">Facial_Keypoints_Detection github code</a></p>
<p><a href="https://www.kaggle.com/c/facial-keypoints-detection" target="_blank" rel="external">facial-keypoints-detection</a>, è¿™æ˜¯ä¸€ä¸ªäººè„¸è¯†åˆ«ä»»åŠ¡ï¼Œä»»åŠ¡æ˜¯è¯†åˆ«äººè„¸å›¾ç‰‡ä¸­çš„çœ¼ç›ã€é¼»å­ã€å˜´çš„ä½ç½®ã€‚è®­ç»ƒé›†åŒ…å«ä»¥ä¸‹15ä¸ªä½ç½®çš„åæ ‡ï¼Œè¡Œæœ«æ˜¯å›¾ç‰‡çš„åƒç´ å€¼ï¼Œå…±96*96ä¸ªåƒç´ å€¼ã€‚æµ‹è¯•é›†åªåŒ…å«å›¾ç‰‡çš„åƒç´ å€¼ã€‚</p>
<pre><code>left_eye_center, right_eye_center, left_eye_inner_corner, left_eye_outer_corner, right_eye_inner_corner, right_eye_outer_corner, left_eyebrow_inner_end, left_eyebrow_outer_end, right_eyebrow_inner_end, right_eyebrow_outer_end, nose_tip, mouth_left_corner, mouth_right_corner, mouth_center_top_lip, mouth_center_bottom_lip
</code></pre><pre><code class="python">import cPickle as pickle
from datetime import datetime
import os
import sys

import numpy as np
import pandas as pd
from lasagne import layers
from nolearn.lasagne import BatchIterator
from nolearn.lasagne import NeuralNet
from pandas.io.parsers import read_csv
from sklearn.utils import shuffle
import theano
</code></pre>
<pre><code>/Library/Python/2.7/site-packages/theano/tensor/signal/downsample.py:6: UserWarning: downsample module has been moved to the theano.tensor.signal.pool module.
  &quot;downsample module has been moved to the theano.tensor.signal.pool module.&quot;)
</code></pre><h2 id="u6570_u636E_u8F7D_u5165_u4E0E_u9884_u89C8"><a href="#u6570_u636E_u8F7D_u5165_u4E0E_u9884_u89C8" class="headerlink" title="æ•°æ®è½½å…¥ä¸é¢„è§ˆ"></a>æ•°æ®è½½å…¥ä¸é¢„è§ˆ</h2><pre><code class="python">train_file = &#39;training.csv&#39;
test_file = &#39;test.csv&#39;

def load(test=False, cols=None):
    &quot;&quot;&quot;
    è½½å…¥æ•°æ®ï¼Œé€šè¿‡å‚æ•°æ§åˆ¶è½½å…¥è®­ç»ƒé›†è¿˜æ˜¯æµ‹è¯•é›†ï¼Œå¹¶ç­›é€‰ç‰¹å¾åˆ—
    &quot;&quot;&quot;
    fname = test_file if test else train_file
    df = pd.read_csv(os.path.expanduser(fname))

    # å°†å›¾åƒæ•°æ®è½¬æ¢ä¸ºæ•°ç»„
    df[&#39;Image&#39;] = df[&#39;Image&#39;].apply(lambda x: np.fromstring(x, sep=&#39; &#39;))

    # ç­›é€‰æŒ‡å®šçš„æ•°æ®åˆ—
    if cols:  
        df = df[list(cols) + [&#39;Image&#39;]]

    print(df.count())  # æ¯åˆ—çš„ç®€å•ç»Ÿè®¡
    df = df.dropna()  # åˆ é™¤ç©ºæ•°æ®

    # å½’ä¸€åŒ–åˆ°0åˆ°1
    X = np.vstack(df[&#39;Image&#39;].values) / 255.  
    X = X.astype(np.float32)

    # é’ˆå¯¹è®­ç»ƒé›†ç›®æ ‡æ ‡ç­¾è¿›è¡Œå½’ä¸€åŒ–
    if not test:
        y = df[df.columns[:-1]].values
        y = (y - 48) / 48  
        X, y = shuffle(X, y, random_state=42)
        y = y.astype(np.float32)
    else:
        y = None

    return X, y
</code></pre>
<pre><code class="python"># å°†å•è¡Œåƒç´ æ•°æ®è½¬æ¢ä¸ºä¸‰ç»´çŸ©é˜µ
def load2d(test=False, cols=None):
    X, y = load(test=test, cols=cols)
    X = X.reshape(-1, 1, 96, 96)
    return X, y
</code></pre>
<h2 id="u6570_u636E_u5904_u7406"><a href="#u6570_u636E_u5904_u7406" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><p>ä¸€ç§æ–¹å¼æ˜¯æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œç”¨æ¥åˆ†ç±»æ‰€æœ‰çš„ç›®æ ‡ç‰¹å¾ã€‚å¦ä¸€ç§æ˜¯é’ˆå¯¹çœ¼é•œã€é¼»å­ã€å˜´åˆ†åˆ«è®¾ç½®ä¸åŒçš„åˆ†ç±»å™¨ï¼Œæ¯ä¸ªåˆ†ç±»å™¨åªé¢„æµ‹å•ä¸ªç›®æ ‡ã€‚é€šè¿‡è§‚å¯Ÿæ•°æ®æˆ‘ä»¬å‘ç°ï¼Œè®­ç»ƒé›†ä¸­æœ‰è®¸å¤šç¼ºå¤±æ•°æ®ï¼Œå¦‚æœè®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œåˆ æ‰ç¼ºå¤±æ•°æ®ä¼šè®©æˆ‘ä»¬çš„æ ·æœ¬é›†å˜å°ï¼Œä¸èƒ½å¾ˆå¥½åœ°åˆ©ç”¨èµ·æ•°æ®ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬äºŒç§æ–¹å¼ï¼Œæ¯ä¸ªç›®æ ‡è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œè¿™æ ·æ›´å¥½çš„åˆ©ç”¨æ ·æœ¬æ•°æ®ã€‚</p>
<pre><code class="python">from collections import OrderedDict
from sklearn.base import clone

SPECIALIST_SETTINGS = [
    dict(
        columns=(
            &#39;left_eye_center_x&#39;, &#39;left_eye_center_y&#39;,
            &#39;right_eye_center_x&#39;, &#39;right_eye_center_y&#39;,
            ),
        flip_indices=((0, 2), (1, 3)),
        ),

    dict(
        columns=(
            &#39;nose_tip_x&#39;, &#39;nose_tip_y&#39;,
            ),
        flip_indices=(),
        ),

    dict(
        columns=(
            &#39;mouth_left_corner_x&#39;, &#39;mouth_left_corner_y&#39;,
            &#39;mouth_right_corner_x&#39;, &#39;mouth_right_corner_y&#39;,
            &#39;mouth_center_top_lip_x&#39;, &#39;mouth_center_top_lip_y&#39;,
            ),
        flip_indices=((0, 2), (1, 3)),
        ),

    dict(
        columns=(
            &#39;mouth_center_bottom_lip_x&#39;,
            &#39;mouth_center_bottom_lip_y&#39;,
            ),
        flip_indices=(),
        ),

    dict(
        columns=(
            &#39;left_eye_inner_corner_x&#39;, &#39;left_eye_inner_corner_y&#39;,
            &#39;right_eye_inner_corner_x&#39;, &#39;right_eye_inner_corner_y&#39;,
            &#39;left_eye_outer_corner_x&#39;, &#39;left_eye_outer_corner_y&#39;,
            &#39;right_eye_outer_corner_x&#39;, &#39;right_eye_outer_corner_y&#39;,
            ),
        flip_indices=((0, 2), (1, 3), (4, 6), (5, 7)),
        ),

    dict(
        columns=(
            &#39;left_eyebrow_inner_end_x&#39;, &#39;left_eyebrow_inner_end_y&#39;,
            &#39;right_eyebrow_inner_end_x&#39;, &#39;right_eyebrow_inner_end_y&#39;,
            &#39;left_eyebrow_outer_end_x&#39;, &#39;left_eyebrow_outer_end_y&#39;,
            &#39;right_eyebrow_outer_end_x&#39;, &#39;right_eyebrow_outer_end_y&#39;,
            ),
        flip_indices=((0, 2), (1, 3), (4, 6), (5, 7)),
        ),
    ]
</code></pre>
<pre><code class="python">class FlipBatchIterator(BatchIterator):
    flip_indices = [
        (0, 2), (1, 3),
        (4, 8), (5, 9), (6, 10), (7, 11),
        (12, 16), (13, 17), (14, 18), (15, 19),
        (22, 24), (23, 25),
        ]

    def transform(self, Xb, yb):
        Xb, yb = super(FlipBatchIterator, self).transform(Xb, yb)

        # Flip half of the images in this batch at random:
        bs = Xb.shape[0]
        indices = np.random.choice(bs, bs / 2, replace=False)
        Xb[indices] = Xb[indices, :, :, ::-1]

        if yb is not None:
            # Horizontal flip of all x coordinates:
            yb[indices, ::2] = yb[indices, ::2] * -1

            # Swap places, e.g. left_eye_center_x -&gt; right_eye_center_x
            for a, b in self.flip_indices:
                yb[indices, a], yb[indices, b] = (
                    yb[indices, b], yb[indices, a])

        return Xb, yb
</code></pre>
<pre><code class="python">class EarlyStopping(object):
    def __init__(self, patience=100):
        self.patience = patience
        self.best_valid = np.inf
        self.best_valid_epoch = 0
        self.best_weights = None

    def __call__(self, nn, train_history):
        current_valid = train_history[-1][&#39;valid_loss&#39;]
        current_epoch = train_history[-1][&#39;epoch&#39;]
        if current_valid &lt; self.best_valid:
            self.best_valid = current_valid
            self.best_valid_epoch = current_epoch
            self.best_weights = nn.get_all_params_values()
        elif self.best_valid_epoch + self.patience &lt; current_epoch:
            print(&quot;Early stopping.&quot;)
            print(&quot;Best valid loss was {:.6f} at epoch {}.&quot;.format(
                self.best_valid, self.best_valid_epoch))
            nn.load_params_from(self.best_weights)
            raise StopIteration()
</code></pre>
<pre><code class="python">class AdjustVariable(object):
    def __init__(self, name, start=0.03, stop=0.001):
        self.name = name
        self.start, self.stop = start, stop
        self.ls = None

    def __call__(self, nn, train_history):
        if self.ls is None:
            self.ls = np.linspace(self.start, self.stop, nn.max_epochs)

        epoch = train_history[-1][&#39;epoch&#39;]
        new_value = np.cast[&#39;float32&#39;](self.ls[epoch - 1])
        getattr(nn, self.name).set_value(new_value)
</code></pre>
<pre><code class="python">def float32(k):
    return np.cast[&#39;float32&#39;](k)

net = NeuralNet(
    layers=[
        (&#39;input&#39;, layers.InputLayer),
        (&#39;conv1&#39;, layers.Conv2DLayer),
        (&#39;pool1&#39;, layers.MaxPool2DLayer),
        (&#39;dropout1&#39;, layers.DropoutLayer),
        (&#39;conv2&#39;, layers.Conv2DLayer),
        (&#39;pool2&#39;, layers.MaxPool2DLayer),
        (&#39;dropout2&#39;, layers.DropoutLayer),
        (&#39;conv3&#39;, layers.Conv2DLayer),
        (&#39;pool3&#39;, layers.MaxPool2DLayer),
        (&#39;dropout3&#39;, layers.DropoutLayer),
        (&#39;hidden4&#39;, layers.DenseLayer),
        (&#39;dropout4&#39;, layers.DropoutLayer),
        (&#39;hidden5&#39;, layers.DenseLayer),
        (&#39;output&#39;, layers.DenseLayer),
        ],
    input_shape=(None, 1, 96, 96),
    conv1_num_filters=32, conv1_filter_size=(3, 3), pool1_pool_size=(2, 2),
    dropout1_p=0.1,
    conv2_num_filters=64, conv2_filter_size=(2, 2), pool2_pool_size=(2, 2),
    dropout2_p=0.2,
    conv3_num_filters=128, conv3_filter_size=(2, 2), pool3_pool_size=(2, 2),
    dropout3_p=0.3,
    hidden4_num_units=300,
    dropout4_p=0.5,
    hidden5_num_units=300,
    output_num_units=30, output_nonlinearity=None,

    update_learning_rate=theano.shared(float32(0.03)),
    update_momentum=theano.shared(float32(0.9)),

    regression=True,
    batch_iterator_train = BatchIterator(batch_size = 100),
    batch_iterator_test = BatchIterator(batch_size = 100),
#     batch_iterator_train=FlipBatchIterator(batch_size=128),
#     on_epoch_finished=[
#         AdjustVariable(&#39;update_learning_rate&#39;, start=0.03, stop=0.0001),
#         AdjustVariable(&#39;update_momentum&#39;, start=0.9, stop=0.999),
#         EarlyStopping(patience=200),
#         ],
    max_epochs=10,
    verbose=1,
)
</code></pre>
<pre><code class="python">def fit_specialists(fname_pretrain=None):
    if fname_pretrain:
        with open(fname_pretrain, &#39;rb&#39;) as f:
            net_pretrain = pickle.load(f)
    else:
        net_pretrain = None

    specialists = OrderedDict()

    for setting in SPECIALIST_SETTINGS:
        cols = setting[&#39;columns&#39;]
        X, y = load2d(cols=cols)

        model = clone(net)
        model.output_num_units = y.shape[1]
        model.batch_iterator_train.flip_indices = setting[&#39;flip_indices&#39;]
        model.max_epochs = int(4e6 / y.shape[0])
        if &#39;kwargs&#39; in setting:
            # an option &#39;kwargs&#39; in the settings list may be used to
            # set any other parameter of the net:
            vars(model).update(setting[&#39;kwargs&#39;])

        if net_pretrain is not None:
            # if a pretrain model was given, use it to initialize the
            # weights of our new specialist model:
            model.load_params_from(net_pretrain)

        print(&quot;Training model for columns {} for {} epochs&quot;.format(
            cols, model.max_epochs))
        model.fit(X, y)
        specialists[cols] = model

    with open(&#39;net-specialists.pickle&#39;, &#39;wb&#39;) as f:
        # this time we&#39;re persisting a dictionary with all models:
        pickle.dump(specialists, f, -1)
</code></pre>
<pre><code class="python">def predict(fname_specialists=&#39;net-specialists.pickle&#39;):
    with open(fname_specialists, &#39;rb&#39;) as f:
        specialists = pickle.load(f)

    X = load2d(test=True)[0]
    y_pred = np.empty((X.shape[0], 0))

    for model in specialists.values():
        y_pred1 = model.predict(X)
        y_pred = np.hstack([y_pred, y_pred1])

    columns = ()
    for cols in specialists.keys():
        columns += cols

    y_pred2 = y_pred * 48 + 48
    y_pred2 = y_pred2.clip(0, 96)
    df = DataFrame(y_pred2, columns=columns)

    lookup_table = read_csv(os.path.expanduser(FLOOKUP))
    values = []

    for index, row in lookup_table.iterrows():
        values.append((
            row[&#39;RowId&#39;],
            df.ix[row.ImageId - 1][row.FeatureName],
            ))

    now_str = datetime.now().isoformat().replace(&#39;:&#39;, &#39;-&#39;)
    submission = DataFrame(values, columns=(&#39;RowId&#39;, &#39;Location&#39;))
    filename = &#39;submission-{}.csv&#39;.format(now_str)
    submission.to_csv(filename, index=False)
    print(&quot;Wrote {}&quot;.format(filename))
</code></pre>
<pre><code class="python">if __name__ == &#39;__main__&#39;:
    fit_specialists()
    predict()
</code></pre>
<pre><code>left_eye_center_x     7039
left_eye_center_y     7039
right_eye_center_x    7036
right_eye_center_y    7036
Image                 7049
dtype: int64
Training model for columns (&#39;left_eye_center_x&#39;, &#39;left_eye_center_y&#39;, &#39;right_eye_center_x&#39;, &#39;right_eye_center_y&#39;) for 568 epochs


/Library/Python/2.7/site-packages/lasagne/layers/conv.py:489: UserWarning: The `image_shape` keyword argument to `tensor.nnet.conv2d` is deprecated, it has been renamed to `input_shape`.
  border_mode=border_mode)


# Neural Network with 4779676 learnable parameters

## Layer information

  #  name      size
---  --------  ---------
  0  input     1x96x96
  1  conv1     32x94x94
  2  pool1     32x47x47
  3  dropout1  32x47x47
  4  conv2     64x46x46
  5  pool2     64x23x23
  6  dropout2  64x23x23
  7  conv3     128x22x22
  8  pool3     128x11x11
  9  dropout3  128x11x11
 10  hidden4   300
 11  dropout4  300
 12  hidden5   300
 13  output    4

# Neural Network with 4779676 learnable parameters

## Layer information

  #  name      size
---  --------  ---------
  0  input     1x96x96
  1  conv1     32x94x94
  2  pool1     32x47x47
  3  dropout1  32x47x47
  4  conv2     64x46x46
  5  pool2     64x23x23
  6  dropout2  64x23x23
  7  conv3     128x22x22
  8  pool3     128x11x11
  9  dropout3  128x11x11
 10  hidden4   300
 11  dropout4  300
 12  hidden5   300
 13  output    4

  epoch    trn loss    val loss    trn/val  dur
-------  ----------  ----------  ---------  -------
      1     [36m0.01113[0m     [32m0.00475[0m    2.34387  181.86s
  epoch    trn loss    val loss    trn/val  dur
-------  ----------  ----------  ---------  -------
      1     [36m0.01113[0m     [32m0.00475[0m    2.34387  181.86s
</code></pre><h3 id="Warning"><a href="#Warning" class="headerlink" title="Warning"></a>Warning</h3><p>å•æœºæ‰§è¡Œå®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨Amazon AWSçš„GPUå®ä¾‹æ¥è¿è¡Œç¨‹åºï¼Œåˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹å‚è§ï¼š<a href="https://www.kaggle.com/c/facial-keypoints-detection/details/deep-learning-tutorial" target="_blank" rel="external">deep-learning-tutorial</a></p>
<p>åœ¨è¿è¡Œå®ä¾‹ä¹‹åè¿˜æœ‰å‡ ç‚¹è¦åšï¼š</p>
<ol>
<li>å®‰è£…python pip &gt; sudo apt-get install python-pip python-dev build-essential   </li>
<li>åˆ›å»ºKaggle cookiesæ–‡ä»¶ï¼Œä¸ºäº†ä¸‹è½½è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å°†æœ¬åœ°æµè§ˆå™¨ä¸­çš„cookieså¯¼å‡ºï¼Œé€šè¿‡chrome æ’ä»¶ï¼š<a href="https://chrome.google.com/webstore/detail/cookietxt-export/lopabhfecdfhgogdbojmaicoicjekelh/related" target="_blank" rel="external">https://chrome.google.com/webstore/detail/cookietxt-export/lopabhfecdfhgogdbojmaicoicjekelh/related</a>   </li>
<li>æŠŠGithubä¸­çš„<a href="https://github.com/wendykan/AWSGPU_DeepLearning" target="_blank" rel="external">https://github.com/wendykan/AWSGPU_DeepLearning</a> cloneåˆ°ä½ çš„AWSå®ä¾‹ä¸­ï¼Œè¿›è¡Œä¸€äº›æœºå™¨å­¦ä¹ çš„åˆå§‹åŒ–å·¥ä½œã€‚  </li>
</ol>
<p>ä¸€äº›å‚è€ƒï¼š<br><a href="http://ramhiser.com/2016/01/05/installing-tensorflow-on-an-aws-ec2-instance-with-gpu-support/" target="_blank" rel="external">http://ramhiser.com/2016/01/05/installing-tensorflow-on-an-aws-ec2-instance-with-gpu-support/</a><br><a href="http://danielnouri.org/notes/2014/12/17/using-convolutional-neural-nets-to-detect-facial-keypoints-tutorial/" target="_blank" rel="external">http://danielnouri.org/notes/2014/12/17/using-convolutional-neural-nets-to-detect-facial-keypoints-tutorial/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/08/26/algo/kaggle/facial_keypoints/" data-id="ciucofbxt00401fjhi5u62cqv" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/08/26/algo/kaggle/facial_keypoints/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kaggle/">kaggle</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/">&laquo; ä¸Šä¸€é¡µ</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/3/">ä¸‹ä¸€é¡µ &raquo;</a>
      </nav>
    </section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul id="recent-post" class="">
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/10/10/dev/esop/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/dev/">dev</a></p>
              <p class="item-title"><a href="/2016/10/10/dev/esop/" class="title">Elasticsearch-ç´¢å¼•ä¼˜åŒ–</a></p>
              <p class="item-date"><time datetime="2016-10-10T02:19:56.000Z" itemprop="datePublished">2016-10-10</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/09/18/algo/ml/categorical_features/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/machine-learning/">machine learning</a></p>
              <p class="item-title"><a href="/2016/09/18/algo/ml/categorical_features/" class="title">Handling categorical features</a></p>
              <p class="item-date"><time datetime="2016-09-17T16:00:00.000Z" itemprop="datePublished">2016-09-18</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/09/18/algo/sklearn/Dummification_vs_encoding/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/machine-learning/">machine learning</a></p>
              <p class="item-title"><a href="/2016/09/18/algo/sklearn/Dummification_vs_encoding/" class="title">XGBoost Categorical Variables - Dummification vs encoding</a></p>
              <p class="item-date"><time datetime="2016-09-17T16:00:00.000Z" itemprop="datePublished">2016-09-18</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/09/14/algo/one_hot_encode/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/machine-learning/">machine learning</a></p>
              <p class="item-title"><a href="/2016/09/14/algo/one_hot_encode/" class="title">One-Hot Encoding</a></p>
              <p class="item-date"><time datetime="2016-09-13T16:00:00.000Z" itemprop="datePublished">2016-09-14</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/09/12/system/linux_grep/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/system/">system</a></p>
              <p class="item-title"><a href="/2016/09/12/system/linux_grep/" class="title">LinuxæŸ¥æ‰¾æ–‡ä»¶å†…å®¹ï¼ˆgrepï¼‰</a></p>
              <p class="item-date"><time datetime="2016-09-11T16:00:00.000Z" itemprop="datePublished">2016-09-12</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">åˆ†ç±»</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hash/">Hash</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hive/">Hive</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Photo/">Photo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zabbix/">Zabbix</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ads/">ads</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/c/">c++</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/dev/">dev</a><span class="category-list-count">32</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/github/">github</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/internet/">internet</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kaggle/">kaggle</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/machine-learning/">machine learning</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/sklearn/">sklearn</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/system/">system</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/travel/">travel</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾äº‘</h3>
    <div class="widget tagcloud">
      <a href="/tags/Apache/" style="font-size: 10px;">Apache</a> <a href="/tags/Bandits/" style="font-size: 12.5px;">Bandits</a> <a href="/tags/Elasticsearch-docker/" style="font-size: 10px;">Elasticsearch, docker</a> <a href="/tags/FlatBuffers/" style="font-size: 10px;">FlatBuffers</a> <a href="/tags/Google/" style="font-size: 10px;">Google</a> <a href="/tags/Granger-causality/" style="font-size: 10px;">Granger causality</a> <a href="/tags/GridSearchCV/" style="font-size: 10px;">GridSearchCV</a> <a href="/tags/HTTPS/" style="font-size: 10px;">HTTPS</a> <a href="/tags/Jquery/" style="font-size: 10px;">Jquery</a> <a href="/tags/MapReduce/" style="font-size: 10px;">MapReduce</a> <a href="/tags/Mock/" style="font-size: 10px;">Mock</a> <a href="/tags/Monument-Vallay/" style="font-size: 10px;">Monument Vallay</a> <a href="/tags/Mysql/" style="font-size: 12.5px;">Mysql</a> <a href="/tags/PPTP-vpn/" style="font-size: 12.5px;">PPTP, vpn</a> <a href="/tags/Photoshop/" style="font-size: 10px;">Photoshop</a> <a href="/tags/Pipeline/" style="font-size: 10px;">Pipeline</a> <a href="/tags/Shadowsocks/" style="font-size: 10px;">Shadowsocks</a> <a href="/tags/ad/" style="font-size: 10px;">ad</a> <a href="/tags/apache/" style="font-size: 10px;">apache</a> <a href="/tags/blade/" style="font-size: 10px;">blade</a> <a href="/tags/crontab/" style="font-size: 10px;">crontab</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/elasticsearch/" style="font-size: 12.5px;">elasticsearch</a> <a href="/tags/font/" style="font-size: 10px;">font</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/go/" style="font-size: 17.5px;">go</a> <a href="/tags/hashmap/" style="font-size: 10px;">hashmap</a> <a href="/tags/kaggle/" style="font-size: 20px;">kaggle</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/linux-ldd-ä¾èµ–å…³ç³»/" style="font-size: 10px;">linux, ldd, ä¾èµ–å…³ç³»</a> <a href="/tags/lucene/" style="font-size: 10px;">lucene</a> <a href="/tags/nio/" style="font-size: 10px;">nio</a> <a href="/tags/pagerank/" style="font-size: 10px;">pagerank</a> <a href="/tags/photo/" style="font-size: 10px;">photo</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/swift-llvm/" style="font-size: 10px;">swift, llvm</a> <a href="/tags/å‰ç«¯/" style="font-size: 10px;">å‰ç«¯</a> <a href="/tags/å¹¿å‘Š/" style="font-size: 12.5px;">å¹¿å‘Š</a> <a href="/tags/å¼€æºï¼Œè®¸å¯/" style="font-size: 10px;">å¼€æºï¼Œè®¸å¯</a> <a href="/tags/æ¾³é—¨/" style="font-size: 10px;">æ¾³é—¨</a> <a href="/tags/ç›‘æ§ï¼Œzabbix/" style="font-size: 10px;">ç›‘æ§ï¼Œzabbix</a> <a href="/tags/è´å¶æ–¯/" style="font-size: 10px;">è´å¶æ–¯</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">åæœˆ 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">ä¹æœˆ 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">å…«æœˆ 2016</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">äº”æœˆ 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">ä¸‰æœˆ 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">äºŒæœˆ 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">ä¸€æœˆ 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">åäºŒæœˆ 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">åä¸€æœˆ 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">åæœˆ 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">ä¹æœˆ 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">å…­æœˆ 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">äº”æœˆ 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">å››æœˆ 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">ä¸‰æœˆ 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">äºŒæœˆ 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">ä¸€æœˆ 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">åäºŒæœˆ 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">åä¸€æœˆ 2014</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">åæœˆ 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">å…­æœˆ 2014</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">åä¸€æœˆ 2013</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Li Jingpeng<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script type="text/javascript">
  var duoshuoQuery = {short_name:"lijingpeng"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>


<script src="//ajax.css.network/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>