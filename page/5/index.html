<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Frank</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="è®¡ç®—æœº ç½‘ç»œ äº’è”ç½‘">
<meta property="og:type" content="website">
<meta property="og:title" content="Frank">
<meta property="og:url" content="http://www.notehub.cn/page/5/index.html">
<meta property="og:site_name" content="Frank">
<meta property="og:description" content="è®¡ç®—æœº ç½‘ç»œ äº’è”ç½‘">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Frank">
<meta name="twitter:description" content="è®¡ç®—æœº ç½‘ç»œ äº’è”ç½‘">
  
  
    <link rel="icon" href="favicon.png">
  
  <link href='//fonts.css.network/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  <link href="//fonts.css.network/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  

  
</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.jpg)"></i><span class="site-title">Frank</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/logo.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://www.notehub.cn"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/categories">Categories</a></td>
        
          <td><a class="main-nav-link" href="/tags">Tags</a></td>
        
          <td><a class="main-nav-link" href="/about">About</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://www.notehub.cn"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="/css/images/logo.png">
      <h2 id="name">Li Jingpeng</h2>
      <!-- <h3 id="title">undefined</h3> -->
      <span id="location"><i class="fa fa-map-marker"></i>Hangzhou, China</span>
      <a id="follow" href="Https://weibo.com/329299516">å…³æ³¨æˆ‘</a>
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        118
        <span>æ–‡ç« </span>
      </div>
      <div class="article-info-block">
        42
        <span>æ ‡ç­¾</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="https://github.com/lijingpeng" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="#" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="#" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
          
          <td><a href="/me@lijingpeng.org" target="_blank" title="email"><i class="fa fa-email"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
        </tr>
      </table>
    </div>
    
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-algo/kaggle/facial_keypoints" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/26/algo/kaggle/facial_keypoints/">kaggleä¹‹äººè„¸ç‰¹å¾è¯†åˆ«</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/08/26/algo/kaggle/facial_keypoints/">
      <time datetime="2016-08-26T05:48:13.000Z" itemprop="datePublished">2016-08-26</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/kaggle/">kaggle</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p><a href="https://github.com/lijingpeng/kaggle/tree/master/competitions/Facial_Keypoints_Detection" target="_blank" rel="external">Facial_Keypoints_Detection github code</a></p>
<p><a href="https://www.kaggle.com/c/facial-keypoints-detection" target="_blank" rel="external">facial-keypoints-detection</a>, è¿™æ˜¯ä¸€ä¸ªäººè„¸è¯†åˆ«ä»»åŠ¡ï¼Œä»»åŠ¡æ˜¯è¯†åˆ«äººè„¸å›¾ç‰‡ä¸­çš„çœ¼ç›ã€é¼»å­ã€å˜´çš„ä½ç½®ã€‚è®­ç»ƒé›†åŒ…å«ä»¥ä¸‹15ä¸ªä½ç½®çš„åæ ‡ï¼Œè¡Œæœ«æ˜¯å›¾ç‰‡çš„åƒç´ å€¼ï¼Œå…±96*96ä¸ªåƒç´ å€¼ã€‚æµ‹è¯•é›†åªåŒ…å«å›¾ç‰‡çš„åƒç´ å€¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">left_eye_center, right_eye_center, left_eye_inner_corner, left_eye_outer_corner, right_eye_inner_corner, right_eye_outer_corner, left_eyebrow_inner_end, left_eyebrow_outer_end, right_eyebrow_inner_end, right_eyebrow_outer_end, nose_tip, mouth_left_corner, mouth_right_corner, mouth_center_top_lip, mouth_center_bottom_lip</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cPickle <span class="keyword">as</span> pickle</div><div class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">from</span> lasagne <span class="keyword">import</span> layers</div><div class="line"><span class="keyword">from</span> nolearn.lasagne <span class="keyword">import</span> BatchIterator</div><div class="line"><span class="keyword">from</span> nolearn.lasagne <span class="keyword">import</span> NeuralNet</div><div class="line"><span class="keyword">from</span> pandas.io.parsers <span class="keyword">import</span> read_csv</div><div class="line"><span class="keyword">from</span> sklearn.utils <span class="keyword">import</span> shuffle</div><div class="line"><span class="keyword">import</span> theano</div></pre></td></tr></table></figure>
<pre><code>/Library/Python/2.7/site-packages/theano/tensor/signal/downsample.py:6: UserWarning: downsample module has been moved to the theano.tensor.signal.pool module.
  &quot;downsample module has been moved to the theano.tensor.signal.pool module.&quot;)
</code></pre><h2 id="u6570_u636E_u8F7D_u5165_u4E0E_u9884_u89C8"><a href="#u6570_u636E_u8F7D_u5165_u4E0E_u9884_u89C8" class="headerlink" title="æ•°æ®è½½å…¥ä¸é¢„è§ˆ"></a>æ•°æ®è½½å…¥ä¸é¢„è§ˆ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">train_file = <span class="string">'training.csv'</span></div><div class="line">test_file = <span class="string">'test.csv'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load</span><span class="params">(test=False, cols=None)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    è½½å…¥æ•°æ®ï¼Œé€šè¿‡å‚æ•°æ§åˆ¶è½½å…¥è®­ç»ƒé›†è¿˜æ˜¯æµ‹è¯•é›†ï¼Œå¹¶ç­›é€‰ç‰¹å¾åˆ—</div><div class="line">    """</div><div class="line">    fname = test_file <span class="keyword">if</span> test <span class="keyword">else</span> train_file</div><div class="line">    df = pd.read_csv(os.path.expanduser(fname))</div><div class="line"></div><div class="line">    <span class="comment"># å°†å›¾åƒæ•°æ®è½¬æ¢ä¸ºæ•°ç»„</span></div><div class="line">    df[<span class="string">'Image'</span>] = df[<span class="string">'Image'</span>].apply(<span class="keyword">lambda</span> x: np.fromstring(x, sep=<span class="string">' '</span>))</div><div class="line"></div><div class="line">    <span class="comment"># ç­›é€‰æŒ‡å®šçš„æ•°æ®åˆ—</span></div><div class="line">    <span class="keyword">if</span> cols:  </div><div class="line">        df = df[list(cols) + [<span class="string">'Image'</span>]]</div><div class="line"></div><div class="line">    print(df.count())  <span class="comment"># æ¯åˆ—çš„ç®€å•ç»Ÿè®¡</span></div><div class="line">    df = df.dropna()  <span class="comment"># åˆ é™¤ç©ºæ•°æ®</span></div><div class="line"></div><div class="line">    <span class="comment"># å½’ä¸€åŒ–åˆ°0åˆ°1</span></div><div class="line">    X = np.vstack(df[<span class="string">'Image'</span>].values) / <span class="number">255.</span>  </div><div class="line">    X = X.astype(np.float32)</div><div class="line"></div><div class="line">    <span class="comment"># é’ˆå¯¹è®­ç»ƒé›†ç›®æ ‡æ ‡ç­¾è¿›è¡Œå½’ä¸€åŒ–</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> test:</div><div class="line">        y = df[df.columns[:<span class="number">-1</span>]].values</div><div class="line">        y = (y - <span class="number">48</span>) / <span class="number">48</span>  </div><div class="line">        X, y = shuffle(X, y, random_state=<span class="number">42</span>)</div><div class="line">        y = y.astype(np.float32)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        y = <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> X, y</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å°†å•è¡Œåƒç´ æ•°æ®è½¬æ¢ä¸ºä¸‰ç»´çŸ©é˜µ</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load2d</span><span class="params">(test=False, cols=None)</span>:</span></div><div class="line">    X, y = load(test=test, cols=cols)</div><div class="line">    X = X.reshape(<span class="number">-1</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">96</span>)</div><div class="line">    <span class="keyword">return</span> X, y</div></pre></td></tr></table></figure>
<h2 id="u6570_u636E_u5904_u7406"><a href="#u6570_u636E_u5904_u7406" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><p>ä¸€ç§æ–¹å¼æ˜¯æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œç”¨æ¥åˆ†ç±»æ‰€æœ‰çš„ç›®æ ‡ç‰¹å¾ã€‚å¦ä¸€ç§æ˜¯é’ˆå¯¹çœ¼é•œã€é¼»å­ã€å˜´åˆ†åˆ«è®¾ç½®ä¸åŒçš„åˆ†ç±»å™¨ï¼Œæ¯ä¸ªåˆ†ç±»å™¨åªé¢„æµ‹å•ä¸ªç›®æ ‡ã€‚é€šè¿‡è§‚å¯Ÿæ•°æ®æˆ‘ä»¬å‘ç°ï¼Œè®­ç»ƒé›†ä¸­æœ‰è®¸å¤šç¼ºå¤±æ•°æ®ï¼Œå¦‚æœè®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œåˆ æ‰ç¼ºå¤±æ•°æ®ä¼šè®©æˆ‘ä»¬çš„æ ·æœ¬é›†å˜å°ï¼Œä¸èƒ½å¾ˆå¥½åœ°åˆ©ç”¨èµ·æ•°æ®ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬äºŒç§æ–¹å¼ï¼Œæ¯ä¸ªç›®æ ‡è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œè¿™æ ·æ›´å¥½çš„åˆ©ç”¨æ ·æœ¬æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</div><div class="line"><span class="keyword">from</span> sklearn.base <span class="keyword">import</span> clone</div><div class="line"></div><div class="line">SPECIALIST_SETTINGS = [</div><div class="line">    dict(</div><div class="line">        columns=(</div><div class="line">            <span class="string">'left_eye_center_x'</span>, <span class="string">'left_eye_center_y'</span>,</div><div class="line">            <span class="string">'right_eye_center_x'</span>, <span class="string">'right_eye_center_y'</span>,</div><div class="line">            ),</div><div class="line">        flip_indices=((<span class="number">0</span>, <span class="number">2</span>), (<span class="number">1</span>, <span class="number">3</span>)),</div><div class="line">        ),</div><div class="line"></div><div class="line">    dict(</div><div class="line">        columns=(</div><div class="line">            <span class="string">'nose_tip_x'</span>, <span class="string">'nose_tip_y'</span>,</div><div class="line">            ),</div><div class="line">        flip_indices=(),</div><div class="line">        ),</div><div class="line"></div><div class="line">    dict(</div><div class="line">        columns=(</div><div class="line">            <span class="string">'mouth_left_corner_x'</span>, <span class="string">'mouth_left_corner_y'</span>,</div><div class="line">            <span class="string">'mouth_right_corner_x'</span>, <span class="string">'mouth_right_corner_y'</span>,</div><div class="line">            <span class="string">'mouth_center_top_lip_x'</span>, <span class="string">'mouth_center_top_lip_y'</span>,</div><div class="line">            ),</div><div class="line">        flip_indices=((<span class="number">0</span>, <span class="number">2</span>), (<span class="number">1</span>, <span class="number">3</span>)),</div><div class="line">        ),</div><div class="line"></div><div class="line">    dict(</div><div class="line">        columns=(</div><div class="line">            <span class="string">'mouth_center_bottom_lip_x'</span>,</div><div class="line">            <span class="string">'mouth_center_bottom_lip_y'</span>,</div><div class="line">            ),</div><div class="line">        flip_indices=(),</div><div class="line">        ),</div><div class="line"></div><div class="line">    dict(</div><div class="line">        columns=(</div><div class="line">            <span class="string">'left_eye_inner_corner_x'</span>, <span class="string">'left_eye_inner_corner_y'</span>,</div><div class="line">            <span class="string">'right_eye_inner_corner_x'</span>, <span class="string">'right_eye_inner_corner_y'</span>,</div><div class="line">            <span class="string">'left_eye_outer_corner_x'</span>, <span class="string">'left_eye_outer_corner_y'</span>,</div><div class="line">            <span class="string">'right_eye_outer_corner_x'</span>, <span class="string">'right_eye_outer_corner_y'</span>,</div><div class="line">            ),</div><div class="line">        flip_indices=((<span class="number">0</span>, <span class="number">2</span>), (<span class="number">1</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">6</span>), (<span class="number">5</span>, <span class="number">7</span>)),</div><div class="line">        ),</div><div class="line"></div><div class="line">    dict(</div><div class="line">        columns=(</div><div class="line">            <span class="string">'left_eyebrow_inner_end_x'</span>, <span class="string">'left_eyebrow_inner_end_y'</span>,</div><div class="line">            <span class="string">'right_eyebrow_inner_end_x'</span>, <span class="string">'right_eyebrow_inner_end_y'</span>,</div><div class="line">            <span class="string">'left_eyebrow_outer_end_x'</span>, <span class="string">'left_eyebrow_outer_end_y'</span>,</div><div class="line">            <span class="string">'right_eyebrow_outer_end_x'</span>, <span class="string">'right_eyebrow_outer_end_y'</span>,</div><div class="line">            ),</div><div class="line">        flip_indices=((<span class="number">0</span>, <span class="number">2</span>), (<span class="number">1</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">6</span>), (<span class="number">5</span>, <span class="number">7</span>)),</div><div class="line">        ),</div><div class="line">    ]</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FlipBatchIterator</span><span class="params">(BatchIterator)</span>:</span></div><div class="line">    flip_indices = [</div><div class="line">        (<span class="number">0</span>, <span class="number">2</span>), (<span class="number">1</span>, <span class="number">3</span>),</div><div class="line">        (<span class="number">4</span>, <span class="number">8</span>), (<span class="number">5</span>, <span class="number">9</span>), (<span class="number">6</span>, <span class="number">10</span>), (<span class="number">7</span>, <span class="number">11</span>),</div><div class="line">        (<span class="number">12</span>, <span class="number">16</span>), (<span class="number">13</span>, <span class="number">17</span>), (<span class="number">14</span>, <span class="number">18</span>), (<span class="number">15</span>, <span class="number">19</span>),</div><div class="line">        (<span class="number">22</span>, <span class="number">24</span>), (<span class="number">23</span>, <span class="number">25</span>),</div><div class="line">        ]</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, Xb, yb)</span>:</span></div><div class="line">        Xb, yb = super(FlipBatchIterator, self).transform(Xb, yb)</div><div class="line"></div><div class="line">        <span class="comment"># Flip half of the images in this batch at random:</span></div><div class="line">        bs = Xb.shape[<span class="number">0</span>]</div><div class="line">        indices = np.random.choice(bs, bs / <span class="number">2</span>, replace=<span class="keyword">False</span>)</div><div class="line">        Xb[indices] = Xb[indices, :, :, ::<span class="number">-1</span>]</div><div class="line"></div><div class="line">        <span class="keyword">if</span> yb <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            <span class="comment"># Horizontal flip of all x coordinates:</span></div><div class="line">            yb[indices, ::<span class="number">2</span>] = yb[indices, ::<span class="number">2</span>] * <span class="number">-1</span></div><div class="line"></div><div class="line">            <span class="comment"># Swap places, e.g. left_eye_center_x -&gt; right_eye_center_x</span></div><div class="line">            <span class="keyword">for</span> a, b <span class="keyword">in</span> self.flip_indices:</div><div class="line">                yb[indices, a], yb[indices, b] = (</div><div class="line">                    yb[indices, b], yb[indices, a])</div><div class="line"></div><div class="line">        <span class="keyword">return</span> Xb, yb</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EarlyStopping</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, patience=<span class="number">100</span>)</span>:</span></div><div class="line">        self.patience = patience</div><div class="line">        self.best_valid = np.inf</div><div class="line">        self.best_valid_epoch = <span class="number">0</span></div><div class="line">        self.best_weights = <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, nn, train_history)</span>:</span></div><div class="line">        current_valid = train_history[<span class="number">-1</span>][<span class="string">'valid_loss'</span>]</div><div class="line">        current_epoch = train_history[<span class="number">-1</span>][<span class="string">'epoch'</span>]</div><div class="line">        <span class="keyword">if</span> current_valid &lt; self.best_valid:</div><div class="line">            self.best_valid = current_valid</div><div class="line">            self.best_valid_epoch = current_epoch</div><div class="line">            self.best_weights = nn.get_all_params_values()</div><div class="line">        <span class="keyword">elif</span> self.best_valid_epoch + self.patience &lt; current_epoch:</div><div class="line">            print(<span class="string">"Early stopping."</span>)</div><div class="line">            print(<span class="string">"Best valid loss was &#123;:.6f&#125; at epoch &#123;&#125;."</span>.format(</div><div class="line">                self.best_valid, self.best_valid_epoch))</div><div class="line">            nn.load_params_from(self.best_weights)</div><div class="line">            <span class="keyword">raise</span> StopIteration()</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdjustVariable</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, start=<span class="number">0.03</span>, stop=<span class="number">0.001</span>)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.start, self.stop = start, stop</div><div class="line">        self.ls = <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, nn, train_history)</span>:</span></div><div class="line">        <span class="keyword">if</span> self.ls <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            self.ls = np.linspace(self.start, self.stop, nn.max_epochs)</div><div class="line"></div><div class="line">        epoch = train_history[<span class="number">-1</span>][<span class="string">'epoch'</span>]</div><div class="line">        new_value = np.cast[<span class="string">'float32'</span>](self.ls[epoch - <span class="number">1</span>])</div><div class="line">        getattr(nn, self.name).set_value(new_value)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">float32</span><span class="params">(k)</span>:</span></div><div class="line">    <span class="keyword">return</span> np.cast[<span class="string">'float32'</span>](k)</div><div class="line"></div><div class="line">net = NeuralNet(</div><div class="line">    layers=[</div><div class="line">        (<span class="string">'input'</span>, layers.InputLayer),</div><div class="line">        (<span class="string">'conv1'</span>, layers.Conv2DLayer),</div><div class="line">        (<span class="string">'pool1'</span>, layers.MaxPool2DLayer),</div><div class="line">        (<span class="string">'dropout1'</span>, layers.DropoutLayer),</div><div class="line">        (<span class="string">'conv2'</span>, layers.Conv2DLayer),</div><div class="line">        (<span class="string">'pool2'</span>, layers.MaxPool2DLayer),</div><div class="line">        (<span class="string">'dropout2'</span>, layers.DropoutLayer),</div><div class="line">        (<span class="string">'conv3'</span>, layers.Conv2DLayer),</div><div class="line">        (<span class="string">'pool3'</span>, layers.MaxPool2DLayer),</div><div class="line">        (<span class="string">'dropout3'</span>, layers.DropoutLayer),</div><div class="line">        (<span class="string">'hidden4'</span>, layers.DenseLayer),</div><div class="line">        (<span class="string">'dropout4'</span>, layers.DropoutLayer),</div><div class="line">        (<span class="string">'hidden5'</span>, layers.DenseLayer),</div><div class="line">        (<span class="string">'output'</span>, layers.DenseLayer),</div><div class="line">        ],</div><div class="line">    input_shape=(<span class="keyword">None</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">96</span>),</div><div class="line">    conv1_num_filters=<span class="number">32</span>, conv1_filter_size=(<span class="number">3</span>, <span class="number">3</span>), pool1_pool_size=(<span class="number">2</span>, <span class="number">2</span>),</div><div class="line">    dropout1_p=<span class="number">0.1</span>,</div><div class="line">    conv2_num_filters=<span class="number">64</span>, conv2_filter_size=(<span class="number">2</span>, <span class="number">2</span>), pool2_pool_size=(<span class="number">2</span>, <span class="number">2</span>),</div><div class="line">    dropout2_p=<span class="number">0.2</span>,</div><div class="line">    conv3_num_filters=<span class="number">128</span>, conv3_filter_size=(<span class="number">2</span>, <span class="number">2</span>), pool3_pool_size=(<span class="number">2</span>, <span class="number">2</span>),</div><div class="line">    dropout3_p=<span class="number">0.3</span>,</div><div class="line">    hidden4_num_units=<span class="number">300</span>,</div><div class="line">    dropout4_p=<span class="number">0.5</span>,</div><div class="line">    hidden5_num_units=<span class="number">300</span>,</div><div class="line">    output_num_units=<span class="number">30</span>, output_nonlinearity=<span class="keyword">None</span>,</div><div class="line"></div><div class="line">    update_learning_rate=theano.shared(float32(<span class="number">0.03</span>)),</div><div class="line">    update_momentum=theano.shared(float32(<span class="number">0.9</span>)),</div><div class="line"></div><div class="line">    regression=<span class="keyword">True</span>,</div><div class="line">    batch_iterator_train = BatchIterator(batch_size = <span class="number">100</span>),</div><div class="line">    batch_iterator_test = BatchIterator(batch_size = <span class="number">100</span>),</div><div class="line"><span class="comment">#     batch_iterator_train=FlipBatchIterator(batch_size=128),</span></div><div class="line"><span class="comment">#     on_epoch_finished=[</span></div><div class="line"><span class="comment">#         AdjustVariable('update_learning_rate', start=0.03, stop=0.0001),</span></div><div class="line"><span class="comment">#         AdjustVariable('update_momentum', start=0.9, stop=0.999),</span></div><div class="line"><span class="comment">#         EarlyStopping(patience=200),</span></div><div class="line"><span class="comment">#         ],</span></div><div class="line">    max_epochs=<span class="number">10</span>,</div><div class="line">    verbose=<span class="number">1</span>,</div><div class="line">)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit_specialists</span><span class="params">(fname_pretrain=None)</span>:</span></div><div class="line">    <span class="keyword">if</span> fname_pretrain:</div><div class="line">        <span class="keyword">with</span> open(fname_pretrain, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</div><div class="line">            net_pretrain = pickle.load(f)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        net_pretrain = <span class="keyword">None</span></div><div class="line"></div><div class="line">    specialists = OrderedDict()</div><div class="line"></div><div class="line">    <span class="keyword">for</span> setting <span class="keyword">in</span> SPECIALIST_SETTINGS:</div><div class="line">        cols = setting[<span class="string">'columns'</span>]</div><div class="line">        X, y = load2d(cols=cols)</div><div class="line"></div><div class="line">        model = clone(net)</div><div class="line">        model.output_num_units = y.shape[<span class="number">1</span>]</div><div class="line">        model.batch_iterator_train.flip_indices = setting[<span class="string">'flip_indices'</span>]</div><div class="line">        model.max_epochs = int(<span class="number">4e6</span> / y.shape[<span class="number">0</span>])</div><div class="line">        <span class="keyword">if</span> <span class="string">'kwargs'</span> <span class="keyword">in</span> setting:</div><div class="line">            <span class="comment"># an option 'kwargs' in the settings list may be used to</span></div><div class="line">            <span class="comment"># set any other parameter of the net:</span></div><div class="line">            vars(model).update(setting[<span class="string">'kwargs'</span>])</div><div class="line"></div><div class="line">        <span class="keyword">if</span> net_pretrain <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            <span class="comment"># if a pretrain model was given, use it to initialize the</span></div><div class="line">            <span class="comment"># weights of our new specialist model:</span></div><div class="line">            model.load_params_from(net_pretrain)</div><div class="line"></div><div class="line">        print(<span class="string">"Training model for columns &#123;&#125; for &#123;&#125; epochs"</span>.format(</div><div class="line">            cols, model.max_epochs))</div><div class="line">        model.fit(X, y)</div><div class="line">        specialists[cols] = model</div><div class="line"></div><div class="line">    <span class="keyword">with</span> open(<span class="string">'net-specialists.pickle'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">        <span class="comment"># this time we're persisting a dictionary with all models:</span></div><div class="line">        pickle.dump(specialists, f, <span class="number">-1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(fname_specialists=<span class="string">'net-specialists.pickle'</span>)</span>:</span></div><div class="line">    <span class="keyword">with</span> open(fname_specialists, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</div><div class="line">        specialists = pickle.load(f)</div><div class="line"></div><div class="line">    X = load2d(test=<span class="keyword">True</span>)[<span class="number">0</span>]</div><div class="line">    y_pred = np.empty((X.shape[<span class="number">0</span>], <span class="number">0</span>))</div><div class="line"></div><div class="line">    <span class="keyword">for</span> model <span class="keyword">in</span> specialists.values():</div><div class="line">        y_pred1 = model.predict(X)</div><div class="line">        y_pred = np.hstack([y_pred, y_pred1])</div><div class="line"></div><div class="line">    columns = ()</div><div class="line">    <span class="keyword">for</span> cols <span class="keyword">in</span> specialists.keys():</div><div class="line">        columns += cols</div><div class="line"></div><div class="line">    y_pred2 = y_pred * <span class="number">48</span> + <span class="number">48</span></div><div class="line">    y_pred2 = y_pred2.clip(<span class="number">0</span>, <span class="number">96</span>)</div><div class="line">    df = DataFrame(y_pred2, columns=columns)</div><div class="line"></div><div class="line">    lookup_table = read_csv(os.path.expanduser(FLOOKUP))</div><div class="line">    values = []</div><div class="line"></div><div class="line">    <span class="keyword">for</span> index, row <span class="keyword">in</span> lookup_table.iterrows():</div><div class="line">        values.append((</div><div class="line">            row[<span class="string">'RowId'</span>],</div><div class="line">            df.ix[row.ImageId - <span class="number">1</span>][row.FeatureName],</div><div class="line">            ))</div><div class="line"></div><div class="line">    now_str = datetime.now().isoformat().replace(<span class="string">':'</span>, <span class="string">'-'</span>)</div><div class="line">    submission = DataFrame(values, columns=(<span class="string">'RowId'</span>, <span class="string">'Location'</span>))</div><div class="line">    filename = <span class="string">'submission-&#123;&#125;.csv'</span>.format(now_str)</div><div class="line">    submission.to_csv(filename, index=<span class="keyword">False</span>)</div><div class="line">    print(<span class="string">"Wrote &#123;&#125;"</span>.format(filename))</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    fit_specialists()</div><div class="line">    predict()</div></pre></td></tr></table></figure>
<pre><code>left_eye_center_x     7039
left_eye_center_y     7039
right_eye_center_x    7036
right_eye_center_y    7036
Image                 7049
dtype: int64
Training model for columns (&apos;left_eye_center_x&apos;, &apos;left_eye_center_y&apos;, &apos;right_eye_center_x&apos;, &apos;right_eye_center_y&apos;) for 568 epochs


/Library/Python/2.7/site-packages/lasagne/layers/conv.py:489: UserWarning: The `image_shape` keyword argument to `tensor.nnet.conv2d` is deprecated, it has been renamed to `input_shape`.
  border_mode=border_mode)


# Neural Network with 4779676 learnable parameters

## Layer information

  #  name      size
---  --------  ---------
  0  input     1x96x96
  1  conv1     32x94x94
  2  pool1     32x47x47
  3  dropout1  32x47x47
  4  conv2     64x46x46
  5  pool2     64x23x23
  6  dropout2  64x23x23
  7  conv3     128x22x22
  8  pool3     128x11x11
  9  dropout3  128x11x11
 10  hidden4   300
 11  dropout4  300
 12  hidden5   300
 13  output    4

# Neural Network with 4779676 learnable parameters

## Layer information

  #  name      size
---  --------  ---------
  0  input     1x96x96
  1  conv1     32x94x94
  2  pool1     32x47x47
  3  dropout1  32x47x47
  4  conv2     64x46x46
  5  pool2     64x23x23
  6  dropout2  64x23x23
  7  conv3     128x22x22
  8  pool3     128x11x11
  9  dropout3  128x11x11
 10  hidden4   300
 11  dropout4  300
 12  hidden5   300
 13  output    4

  epoch    trn loss    val loss    trn/val  dur
-------  ----------  ----------  ---------  -------
      1     [36m0.01113[0m     [32m0.00475[0m    2.34387  181.86s
  epoch    trn loss    val loss    trn/val  dur
-------  ----------  ----------  ---------  -------
      1     [36m0.01113[0m     [32m0.00475[0m    2.34387  181.86s
</code></pre><h3 id="Warning"><a href="#Warning" class="headerlink" title="Warning"></a>Warning</h3><p>å•æœºæ‰§è¡Œå®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨Amazon AWSçš„GPUå®ä¾‹æ¥è¿è¡Œç¨‹åºï¼Œåˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹å‚è§ï¼š<a href="https://www.kaggle.com/c/facial-keypoints-detection/details/deep-learning-tutorial" target="_blank" rel="external">deep-learning-tutorial</a></p>
<p>åœ¨è¿è¡Œå®ä¾‹ä¹‹åè¿˜æœ‰å‡ ç‚¹è¦åšï¼š</p>
<ol>
<li>å®‰è£…python pip &gt; sudo apt-get install python-pip python-dev build-essential   </li>
<li>åˆ›å»ºKaggle cookiesæ–‡ä»¶ï¼Œä¸ºäº†ä¸‹è½½è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å°†æœ¬åœ°æµè§ˆå™¨ä¸­çš„cookieså¯¼å‡ºï¼Œé€šè¿‡chrome æ’ä»¶ï¼š<a href="https://chrome.google.com/webstore/detail/cookietxt-export/lopabhfecdfhgogdbojmaicoicjekelh/related" target="_blank" rel="external">https://chrome.google.com/webstore/detail/cookietxt-export/lopabhfecdfhgogdbojmaicoicjekelh/related</a>   </li>
<li>æŠŠGithubä¸­çš„<a href="https://github.com/wendykan/AWSGPU_DeepLearning" target="_blank" rel="external">https://github.com/wendykan/AWSGPU_DeepLearning</a> cloneåˆ°ä½ çš„AWSå®ä¾‹ä¸­ï¼Œè¿›è¡Œä¸€äº›æœºå™¨å­¦ä¹ çš„åˆå§‹åŒ–å·¥ä½œã€‚  </li>
</ol>
<p>ä¸€äº›å‚è€ƒï¼š<br><a href="http://ramhiser.com/2016/01/05/installing-tensorflow-on-an-aws-ec2-instance-with-gpu-support/" target="_blank" rel="external">http://ramhiser.com/2016/01/05/installing-tensorflow-on-an-aws-ec2-instance-with-gpu-support/</a><br><a href="http://danielnouri.org/notes/2014/12/17/using-convolutional-neural-nets-to-detect-facial-keypoints-tutorial/" target="_blank" rel="external">http://danielnouri.org/notes/2014/12/17/using-convolutional-neural-nets-to-detect-facial-keypoints-tutorial/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/08/26/algo/kaggle/facial_keypoints/" data-id="cj3uvlzqj0040bms9gmvv8bhd" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/08/26/algo/kaggle/facial_keypoints/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kaggle/">kaggle</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-algo/ml/hmm_crf" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/25/algo/ml/hmm_crf/">ä¸€å¼ å…³äºè´å¶æ–¯ã€HMMã€CRFçš„å›¾</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/08/25/algo/ml/hmm_crf/">
      <time datetime="2016-08-24T16:00:00.000Z" itemprop="datePublished">2016-08-25</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/machine-learning/">machine learning</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>è´å¶æ–¯æ˜¯ç”Ÿæˆæ¨¡å‹ï¼Œå¹¶ä¸”å‡è®¾å˜é‡ä¹‹é—´ç›¸äº’ç‹¬ç«‹ã€‚é‚£ä¹ˆå¯¹äºåƒNLPä¸­NERè¿™æ ·çš„ä»»åŠ¡æ˜¯è‚¯å®šä¸è¡Œçš„ã€‚HMMçš„å‡ºç°ï¼Œæ‹“å±•äº†è´å¶æ–¯çš„å›¾å…³ç³»ï¼Œmodeläº†è§‚æµ‹å˜é‡çš„markovæ€§ï¼Œä½†æ˜¯ï¼Œå§‹ç»ˆè¡¨è¾¾èƒ½åŠ›ä¸å¤Ÿï¼Œæ²¡æœ‰contextã€‚CRFä¸modelè¾“å‡ºä¸å•ä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»äº†ï¼Œè€Œæ˜¯ä¸LRç±»ä¼¼ï¼Œmodel y ä¸ å‘é‡xä¹‹é—´çš„å…³ç³»ï¼ŒåŠ ä¸Šå›¾çš„local functionçš„è¡¨è¾¾èƒ½åŠ›ä½¿å¾—contextä¿¡æ¯å’Œfeatureæ‰©å±•èƒ½åŠ›å˜å¼ºã€‚äºæ˜¯CRFå¾—åˆ°äº†å¾ˆä¸é”™çš„åº”ç”¨ã€‚</p>
<p><img src="/images/æ¡ä»¶éšæœºåœº.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/08/25/algo/ml/hmm_crf/" data-id="cj3uvlzrc005obms90qwq8fzz" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/08/25/algo/ml/hmm_crf/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
    </footer>
  </div>
  
</article>



    
      <article id="post-algo/sklearn/GridSearchCV" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/24/algo/sklearn/GridSearchCV/">sklearn GridSearchCVç®€ä»‹</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/08/24/algo/sklearn/GridSearchCV/">
      <time datetime="2016-08-24T05:48:13.000Z" itemprop="datePublished">2016-08-24</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/sklearn/">sklearn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sklearn.grid_search.GridSearchCV(estimator,</div><div class="line">    param_grid, scoring=<span class="keyword">None</span>, fit_params=<span class="keyword">None</span>,</div><div class="line">    n_jobs=<span class="number">1</span>, iid=<span class="keyword">True</span>, refit=<span class="keyword">True</span>, cv=<span class="keyword">None</span>,</div><div class="line">    verbose=<span class="number">0</span>, pre_dispatch=<span class="string">'2*n_jobs'</span>, error_score=<span class="string">'raise'</span>)</div></pre></td></tr></table></figure>
<p>GridSearchCVå®ç°äº†fitï¼Œpredictï¼Œpredict_probaç­‰æ–¹æ³•ï¼Œå¹¶é€šè¿‡äº¤å‰éªŒè¯å¯¹å‚æ•°ç©ºé—´è¿›è¡Œæ±‚è§£ï¼Œå¯»æ‰¾æœ€ä½³çš„å‚æ•°ã€‚<br>ä¸‹é¢æ˜¯ä¸€ä¸ªå®˜æ–¹ä»‹ç»ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div><div class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</div><div class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> logging</div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> fetch_20newsgroups</div><div class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer</div><div class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfTransformer</div><div class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> SGDClassifier</div><div class="line"><span class="keyword">from</span> sklearn.grid_search <span class="keyword">import</span> GridSearchCV</div><div class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</div><div class="line"></div><div class="line">print(__doc__)</div><div class="line"></div><div class="line"><span class="comment"># Display progress logs on stdout</span></div><div class="line">logging.basicConfig(level=logging.INFO,</div><div class="line">                    format=<span class="string">'%(asctime)s %(levelname)s %(message)s'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">###############################################################################</span></div><div class="line"><span class="comment"># Load some categories from the training set</span></div><div class="line">categories = [</div><div class="line">    <span class="string">'alt.atheism'</span>,</div><div class="line">    <span class="string">'talk.religion.misc'</span>,</div><div class="line">]</div><div class="line"><span class="comment"># Uncomment the following to do the analysis on all the categories</span></div><div class="line"><span class="comment">#categories = None</span></div><div class="line"></div><div class="line">print(<span class="string">"Loading 20 newsgroups dataset for categories:"</span>)</div><div class="line">print(categories)</div><div class="line"></div><div class="line">data = fetch_20newsgroups(subset=<span class="string">'train'</span>, categories=categories)</div><div class="line">print(<span class="string">"%d documents"</span> % len(data.filenames))</div><div class="line">print(<span class="string">"%d categories"</span> % len(data.target_names))</div><div class="line">print()</div><div class="line"></div><div class="line"><span class="comment">###############################################################################</span></div><div class="line"><span class="comment"># ä½¿ç”¨pipelineå®šä¹‰æ–‡æœ¬åˆ†ç±»é—®é¢˜å¸¸è§çš„å·¥ä½œæµï¼ŒåŒ…å«å‘é‡åŒ–å’Œä¸€ä¸ªç®€å•çš„åˆ†ç±»å™¨</span></div><div class="line">pipeline = Pipeline([</div><div class="line">    (<span class="string">'vect'</span>, CountVectorizer()),</div><div class="line">    (<span class="string">'tfidf'</span>, TfidfTransformer()),</div><div class="line">    (<span class="string">'clf'</span>, SGDClassifier()),</div><div class="line">])</div><div class="line"></div><div class="line"><span class="comment"># å‚æ•°ç©ºé—´ï¼š</span></div><div class="line"><span class="comment"># å®šä¹‰äº†pipelineä¸­å„ä¸ªæ¨¡å‹çš„éœ€è¦ç©·å°½æ±‚è§£çš„å‚æ•°ç©ºé—´ï¼Œæ¯”å¦‚ï¼šclf__penalty': ('l2', 'elasticnet')</span></div><div class="line"><span class="comment"># è¡¨ç¤ºSGDClassifieråˆ†ç±»å™¨çš„æ­£åˆ™åŒ–é€‰é¡¹ä¸ºL2å’Œelasticnetï¼Œè®­ç»ƒæ—¶æ¨¡å‹ä¼šåˆ†åˆ«ä½¿ç”¨è¿™ä¸¤ä¸ªæ­£åˆ™åŒ–æ–¹æ³•æ¥å¯»æ±‚æœ€ä½³çš„æ–¹å¼</span></div><div class="line">parameters = &#123;</div><div class="line">    <span class="string">'vect__max_df'</span>: (<span class="number">0.5</span>, <span class="number">0.75</span>, <span class="number">1.0</span>),</div><div class="line">    <span class="comment">#'vect__max_features': (None, 5000, 10000, 50000),</span></div><div class="line">    <span class="string">'vect__ngram_range'</span>: ((<span class="number">1</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">2</span>)),  <span class="comment"># unigrams or bigrams</span></div><div class="line">    <span class="comment">#'tfidf__use_idf': (True, False),</span></div><div class="line">    <span class="comment">#'tfidf__norm': ('l1', 'l2'),</span></div><div class="line">    <span class="string">'clf__alpha'</span>: (<span class="number">0.00001</span>, <span class="number">0.000001</span>),</div><div class="line">    <span class="string">'clf__penalty'</span>: (<span class="string">'l2'</span>, <span class="string">'elasticnet'</span>),</div><div class="line">    <span class="comment">#'clf__n_iter': (10, 50, 80),</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line"></div><div class="line">    <span class="comment"># é€šè¿‡GridSearchCVæ¥å¯»æ±‚æœ€ä½³å‚æ•°ç©ºé—´</span></div><div class="line">    grid_search = GridSearchCV(pipeline, parameters, n_jobs=<span class="number">-1</span>, verbose=<span class="number">1</span>)</div><div class="line"></div><div class="line">    print(<span class="string">"Performing grid search..."</span>)</div><div class="line">    print(<span class="string">"pipeline:"</span>, [name <span class="keyword">for</span> name, _ <span class="keyword">in</span> pipeline.steps])</div><div class="line">    print(<span class="string">"parameters:"</span>)</div><div class="line">    pprint(parameters)</div><div class="line">    t0 = time()</div><div class="line"></div><div class="line">    <span class="comment"># è¿™é‡Œåªéœ€è°ƒç”¨ä¸€æ¬¡fitå‡½æ•°å°±å¯ä»¥äº†</span></div><div class="line">    grid_search.fit(data.data, data.target)</div><div class="line">    print(<span class="string">"done in %0.3fs"</span> % (time() - t0))</div><div class="line">    print()</div><div class="line"></div><div class="line">    <span class="comment"># è¾“å‡ºbest score</span></div><div class="line">    print(<span class="string">"Best score: %0.3f"</span> % grid_search.best_score_)</div><div class="line">    print(<span class="string">"Best parameters set:"</span>)</div><div class="line">    <span class="comment"># è¾“å‡ºæœ€ä½³çš„åˆ†ç±»å™¨åˆ°åº•ä½¿ç”¨äº†æ€æ ·çš„å‚æ•°</span></div><div class="line">    best_parameters = grid_search.best_estimator_.get_params()</div><div class="line">    <span class="keyword">for</span> param_name <span class="keyword">in</span> sorted(parameters.keys()):</div><div class="line">        print(<span class="string">"\t%s: %r"</span> % (param_name, best_parameters[param_name]))</div></pre></td></tr></table></figure></p>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">Loading 20 newsgroups dataset for categories:</div><div class="line">[&apos;alt.atheism&apos;, &apos;talk.religion.misc&apos;]</div><div class="line">1427 documents</div><div class="line">2 categories</div><div class="line"></div><div class="line">Performing grid search...</div><div class="line">pipeline: [&apos;vect&apos;, &apos;tfidf&apos;, &apos;clf&apos;]</div><div class="line">parameters:</div><div class="line">&#123;&apos;clf__alpha&apos;: (1.0000000000000001e-05, 9.9999999999999995e-07),</div><div class="line"> &apos;clf__n_iter&apos;: (10, 50, 80),</div><div class="line"> &apos;clf__penalty&apos;: (&apos;l2&apos;, &apos;elasticnet&apos;),</div><div class="line"> &apos;tfidf__use_idf&apos;: (True, False),</div><div class="line"> &apos;vect__max_n&apos;: (1, 2),</div><div class="line"> &apos;vect__max_df&apos;: (0.5, 0.75, 1.0),</div><div class="line"> &apos;vect__max_features&apos;: (None, 5000, 10000, 50000)&#125;</div><div class="line">done in 1737.030s</div><div class="line"></div><div class="line">Best score: 0.940</div><div class="line">Best parameters set:</div><div class="line">    clf__alpha: 9.9999999999999995e-07</div><div class="line">    clf__n_iter: 50</div><div class="line">    clf__penalty: &apos;elasticnet&apos;</div><div class="line">    tfidf__use_idf: True</div><div class="line">    vect__max_n: 2</div><div class="line">    vect__max_df: 0.75</div><div class="line">    vect__max_features: 50000</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/08/24/algo/sklearn/GridSearchCV/" data-id="cj3uvlzrj0063bms9lh8ccchu" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/08/24/algo/sklearn/GridSearchCV/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GridSearchCV/">GridSearchCV</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-algo/sklearn/pipeline" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/23/algo/sklearn/pipeline/">sklearn pipelineç®€ä»‹</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/08/23/algo/sklearn/pipeline/">
      <time datetime="2016-08-23T05:48:13.000Z" itemprop="datePublished">2016-08-23</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/sklearn/">sklearn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>Pipelineå¯ä»¥å°†è®¸å¤šç®—æ³•æ¨¡å‹ä¸²è”èµ·æ¥ï¼Œæ¯”å¦‚å°†ç‰¹å¾æå–ã€å½’ä¸€åŒ–ã€åˆ†ç±»ç»„ç»‡åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå…¸å‹çš„æœºå™¨å­¦ä¹ é—®é¢˜å·¥ä½œæµã€‚ä¸»è¦å¸¦æ¥ä¸¤ç‚¹å¥½å¤„ï¼š  </p>
<ol>
<li>ç›´æ¥è°ƒç”¨fitå’Œpredictæ–¹æ³•æ¥å¯¹pipelineä¸­çš„æ‰€æœ‰ç®—æ³•æ¨¡å‹è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹ã€‚  </li>
<li>å¯ä»¥ç»“åˆgrid searchå¯¹å‚æ•°è¿›è¡Œé€‰æ‹©</li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®˜æ–¹æ–‡æ¡£çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>estimators = [(<span class="string">'reduce_dim'</span>, PCA()), (<span class="string">'svm'</span>, SVC())]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>clf = Pipeline(estimators)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>clf</div><div class="line">Pipeline(steps=[(<span class="string">'reduce_dim'</span>, PCA(copy=<span class="keyword">True</span>, n_components=<span class="keyword">None</span>,</div><div class="line">    whiten=<span class="keyword">False</span>)), (<span class="string">'svm'</span>, SVC(C=<span class="number">1.0</span>, cache_size=<span class="number">200</span>, class_weight=<span class="keyword">None</span>,</div><div class="line">    coef0=<span class="number">0.0</span>, decision_function_shape=<span class="keyword">None</span>, degree=<span class="number">3</span>, gamma=<span class="string">'auto'</span>,</div><div class="line">    kernel=<span class="string">'rbf'</span>, max_iter=<span class="number">-1</span>, probability=<span class="keyword">False</span>, random_state=<span class="keyword">None</span>,</div><div class="line">    shrinking=<span class="keyword">True</span>, tol=<span class="number">0.001</span>, verbose=<span class="keyword">False</span>))])</div></pre></td></tr></table></figure>
<p>estimatorsä¸­å®šä¹‰äº†ä¸¤ä¸ªæ¨¡å‹ï¼Œä¸€ä¸ªæ˜¯PCAã€å¦ä¸€ä¸ªæ˜¯SVCã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>clf.set_params(svm__C=<span class="number">10</span>)</div></pre></td></tr></table></figure>
<p>å¯ä»¥é€šè¿‡set_paramså‡½æ•°å¯¹pipelineä¸­çš„æŸä¸ªæ¨¡å‹è®¾å®šå‚æ•°ï¼Œä¸Šé¢æ˜¯å°†svmå‚æ•°Cè®¾ç½®ä¸º10</p>
<p>å¦å¤–ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> samples_generator</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> SelectKBest</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> f_regression</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># generate some data to play with</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>X, y = samples_generator.make_classification(</div><div class="line"><span class="meta">... </span>    n_informative=<span class="number">5</span>, n_redundant=<span class="number">0</span>, random_state=<span class="number">42</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># ANOVA SVM-C</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>anova_filter = SelectKBest(f_regression, k=<span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>clf = svm.SVC(kernel=<span class="string">'linear'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>anova_svm = Pipeline([(<span class="string">'anova'</span>, anova_filter), (<span class="string">'svc'</span>, clf)])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># You can set the parameters using the names issued</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># For instance, fit using a k of 10 in the SelectKBest</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># and a parameter 'C' of the svm</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>anova_svm.set_params(anova__k=<span class="number">10</span>, svc__C=<span class="number">.1</span>).fit(X, y)</div><div class="line"><span class="meta">... </span>                                             </div><div class="line">Pipeline(steps=[...])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>prediction = anova_svm.predict(X)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>anova_svm.score(X, y)                        </div><div class="line"><span class="number">0.77</span>...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># getting the selected features chosen by anova_filter</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>anova_svm.named_steps[<span class="string">'anova'</span>].get_support()</div><div class="line">...</div><div class="line">array([ <span class="keyword">True</span>,  <span class="keyword">True</span>,  <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">False</span>,  <span class="keyword">True</span>, <span class="keyword">False</span>,  <span class="keyword">True</span>,  <span class="keyword">True</span>, <span class="keyword">True</span>,</div><div class="line">       <span class="keyword">False</span>, <span class="keyword">False</span>,  <span class="keyword">True</span>, <span class="keyword">False</span>,  <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>,</div><div class="line">       <span class="keyword">True</span>], dtype=bool)</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/08/23/algo/sklearn/pipeline/" data-id="cj3uvlzri0060bms99qf8fuqu" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/08/23/algo/sklearn/pipeline/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Pipeline/">Pipeline</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-algo/kaggle/image_recognize" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/21/algo/kaggle/image_recognize/">kaggleä¹‹è¯†åˆ«è°·æ­Œè¡—æ™¯å›¾ç‰‡ä¸­çš„å­—æ¯</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/08/21/algo/kaggle/image_recognize/">
      <time datetime="2016-08-21T05:48:13.000Z" itemprop="datePublished">2016-08-21</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/kaggle/">kaggle</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <h2 id="u8BC6_u522B_u8C37_u6B4C_u8857_u666F_u56FE_u7247_u4E2D_u7684_u5B57_u6BCD"><a href="#u8BC6_u522B_u8C37_u6B4C_u8857_u666F_u56FE_u7247_u4E2D_u7684_u5B57_u6BCD" class="headerlink" title="è¯†åˆ«è°·æ­Œè¡—æ™¯å›¾ç‰‡ä¸­çš„å­—æ¯"></a>è¯†åˆ«è°·æ­Œè¡—æ™¯å›¾ç‰‡ä¸­çš„å­—æ¯</h2><p><a href="https://github.com/lijingpeng/kaggle/tree/master/competitions/image_recognize" target="_blank" rel="external">github</a><br><a href="https://www.kaggle.com/c/street-view-getting-started-with-julia" target="_blank" rel="external">street-view-getting-started-with-julia</a> è®©æˆ‘ä»¬ä»è°·æ­Œè¡—æ™¯çš„å›¾ç‰‡ä¸­é‰´å®šå­—æ¯ï¼Œè¿™ä¸ªé¢˜ç›®æ˜¯è®©æˆ‘ä»¬å­¦ä¹ å’Œä½¿ç”¨Juliaï¼ŒJuliaæœ‰pythonå’ŒRçš„æ˜“ç”¨æ€§ï¼Œæœ‰Cè¯­è¨€çš„é€Ÿåº¦ï¼Œæ— å¥ˆå¯¹Juliaä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ‰€ä»¥è¿˜æ˜¯æƒ³ç”¨pythonæ¥è¯•è¯•ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cv2</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¸Œæœ›æ‰€æœ‰çš„å›¾ç‰‡æœ€åå­˜å‚¨åœ¨ä¸€ä¸ªnumpyçš„çŸ©é˜µå½“ä¸­ï¼Œæ¯ä¸€è¡Œä¸ºå›¾ç‰‡çš„åƒç´ å€¼ã€‚ä¸ºäº†å¾—åˆ°ç»Ÿä¸€çš„è¡¨è¾¾å‘¢ï¼Œæˆ‘ä»¬å°†RGBä¸‰ä¸ªé€šé“çš„å€¼åšå¹³å‡å¾—åˆ°çš„ç°åº¦å›¾åƒä½œä¸ºæ¯ä¸ªå›¾ç‰‡çš„è¡¨ç¤º:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># typeData ä¸º"train"æˆ–è€…"test"</span></div><div class="line"><span class="comment"># labelsInfo åŒ…å«æ¯ä¸€ä¸ªå›¾ç‰‡çš„ID</span></div><div class="line"><span class="comment"># å›¾ç‰‡å­˜å‚¨åœ¨trainResizedå’ŒtestResizedæ–‡ä»¶å¤¹å†…</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_data</span><span class="params">(typeData, labelsInfo, imageSize)</span>:</span></div><div class="line">    labelsIndex = labelsInfo[<span class="string">"ID"</span>]</div><div class="line">    x = np.zeros((np.size(labelsIndex), imageSize))</div><div class="line">    <span class="keyword">for</span> idx, idImage <span class="keyword">in</span> enumerate(labelsIndex):</div><div class="line">        <span class="comment"># å¾—åˆ°å›¾ç‰‡æ–‡ä»¶åå¹¶è¯»å–</span></div><div class="line">        nameFile = typeData + <span class="string">"Resized/"</span> + str(idImage) + <span class="string">".Bmp"</span></div><div class="line">        img = cv2.imread(nameFile)</div><div class="line">        <span class="comment"># è½¬åŒ–ä¸ºç°åº¦å›¾</span></div><div class="line">        temp = np.mean(img, <span class="number">2</span>)</div><div class="line">        <span class="comment"># å°†å›¾ç‰‡è½¬åŒ–ä¸ºè¡Œå‘é‡</span></div><div class="line">        x[idx, :] = np.reshape(temp, (<span class="number">1</span>, imageSize))</div><div class="line">    <span class="keyword">return</span> x</div></pre></td></tr></table></figure>
<h3 id="u9884_u5904_u7406_u8BAD_u7EC3_u96C6_u548C_u6D4B_u8BD5_u96C6"><a href="#u9884_u5904_u7406_u8BAD_u7EC3_u96C6_u548C_u6D4B_u8BD5_u96C6" class="headerlink" title="é¢„å¤„ç†è®­ç»ƒé›†å’Œæµ‹è¯•é›†"></a>é¢„å¤„ç†è®­ç»ƒé›†å’Œæµ‹è¯•é›†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">imageSize = <span class="number">400</span></div><div class="line">trainlabels = pd.read_csv(<span class="string">"trainLabels.csv"</span>)</div><div class="line">testlabels = pd.read_csv(<span class="string">"sampleSubmission.csv"</span>)</div><div class="line"><span class="comment"># å¾—åˆ°è®­ç»ƒé›†çš„ç‰¹å¾</span></div><div class="line">xTrain = read_data(<span class="string">'train'</span>, trainlabels, imageSize)</div><div class="line"><span class="comment"># å¾—åˆ°æµ‹è¯•é›†çš„ç‰¹å¾</span></div><div class="line">xTest = read_data(<span class="string">"test"</span>, testlabels, imageSize)</div></pre></td></tr></table></figure>
<h4 id="u9884_u89C8_u6570_u636E_uFF1A"><a href="#u9884_u89C8_u6570_u636E_uFF1A" class="headerlink" title="é¢„è§ˆæ•°æ®ï¼š"></a>é¢„è§ˆæ•°æ®ï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> trainlabels.head(<span class="number">2</span>)</div><div class="line"><span class="keyword">print</span> testlabels.head(<span class="number">2</span>)</div></pre></td></tr></table></figure>
<pre><code>   ID Class
0   1     n
1   2     8
     ID Class
0  6284     A
1  6285     A
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yTrain = trainlabels[<span class="string">"Class"</span>]</div><div class="line">yTrain = [ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> yTrain]</div></pre></td></tr></table></figure>
<h2 id="u6A21_u578B_u8BAD_u7EC3"><a href="#u6A21_u578B_u8BAD_u7EC3" class="headerlink" title="æ¨¡å‹è®­ç»ƒ"></a>æ¨¡å‹è®­ç»ƒ</h2><h3 id="u968F_u673A_u68EE_u6797"><a href="#u968F_u673A_u68EE_u6797" class="headerlink" title="éšæœºæ£®æ—"></a>éšæœºæ£®æ—</h3><p>ä½¿ç”¨éšæœºæ£®æ—è¿›è¡Œè®­ç»ƒï¼Œæ ‘çš„ä¸ªæ•°å’Œæ·±åº¦éœ€è¦å¤šæ¬¡è°ƒè§£å¯»æ±‚æœ€ä½³å€¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</div><div class="line">%time rfc = RandomForestClassifier(n_estimators = <span class="number">500</span>, max_features = <span class="number">50</span>, max_depth=<span class="keyword">None</span>)</div><div class="line">rfc.fit(xTrain, yTrain)</div></pre></td></tr></table></figure>
<pre><code>CPU times: user 121 Âµs, sys: 367 Âµs, total: 488 Âµs
Wall time: 494 Âµs





RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&apos;gini&apos;,
            max_depth=None, max_features=50, max_leaf_nodes=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=500, n_jobs=1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)
</code></pre><h4 id="u9884_u6D4B"><a href="#u9884_u6D4B" class="headerlink" title="é¢„æµ‹"></a>é¢„æµ‹</h4><p>å°†è®­ç»ƒåçš„æ¨¡å‹åº”ç”¨åˆ°æµ‹è¯•é›†ä¸Šï¼Œå¹¶ä¿å­˜ç»“æœï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">predTest = rfc.predict(xTest)</div><div class="line">predResult = [chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> predTest]</div><div class="line">testlabels[<span class="string">"Class"</span>] = predResult</div><div class="line">testlabels.to_csv(<span class="string">"rf_500_50_result.csv"</span>,index = <span class="keyword">None</span>)</div></pre></td></tr></table></figure>
<h4 id="u7ED3_u679C"><a href="#u7ED3_u679C" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h4><p>ä½¿ç”¨50é¢—æ ‘è¿›è¡Œè®­ç»ƒï¼Œæäº¤kaggleä¹‹åå‡†ç¡®ç‡çº¦ä¸º0.40<br>æ”¹ç”¨300é¢—æ ‘è¿›è¡Œè®­ç»ƒï¼Œæäº¤kaggleä¹‹åå‡†ç¡®ç‡ä¸º0.46695<br>æ”¹ç”¨500é¢—æ ‘è¿›è¡Œè®­ç»ƒï¼Œæ·±åº¦ä¸º10ï¼Œæä»·kaggleåå‡†ç¡®ç‡ä¸º0.40ï¼Œä¼°è®¡å‡ºç°äº†è¿‡æ‹Ÿåˆ<br>æ”¹ç”¨500é¢—æ ‘è¿›è¡Œè®­ç»ƒï¼Œä¸è®¾ç½®æ·±åº¦ï¼Œæä»·kaggleåå‡†ç¡®ç‡ä¸º0.47480  </p>
<h3 id="u8D1D_u53F6_u65AF"><a href="#u8D1D_u53F6_u65AF" class="headerlink" title="è´å¶æ–¯"></a>è´å¶æ–¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB <span class="keyword">as</span> GNB</div><div class="line">model_GNB = GNB()</div><div class="line">model_GNB.fit(xTrain, yTrain)</div><div class="line"></div><div class="line">predTest = model_GNB.predict(xTest)</div><div class="line">predResult = [chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> predTest]</div><div class="line">testlabels[<span class="string">"Class"</span>] = predResult</div><div class="line">testlabels.to_csv(<span class="string">"gnb_result.csv"</span>,index = <span class="keyword">None</span>)</div></pre></td></tr></table></figure>
<p>è´å¶æ–¯çš„è®­ç»ƒéå¸¸çš„å¿«ï¼ŒæŠŠç»“æœæäº¤kaggleåï¼Œå¾—åˆ°0.02389çš„å‡†ç¡®ç‡ï¼Œæ˜æ˜¾ä½äºéšæœºæ£®æ—</p>
<h3 id="GBDT"><a href="#GBDT" class="headerlink" title="GBDT"></a>GBDT</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> GradientBoostingClassifier</div><div class="line">%time GBDT = GradientBoostingClassifier(loss=<span class="string">'deviance'</span>, learning_rate=<span class="number">0.1</span>, n_estimators=<span class="number">100</span>, subsample=<span class="number">1.0</span>, \</div><div class="line">                        min_samples_split=<span class="number">2</span>, min_samples_leaf=<span class="number">1</span>, min_weight_fraction_leaf=<span class="number">0.0</span>, max_depth=<span class="number">3</span>, init=<span class="keyword">None</span>, \</div><div class="line">                        random_state=<span class="keyword">None</span>, max_features=<span class="keyword">None</span>, verbose=<span class="number">0</span>, max_leaf_nodes=<span class="keyword">None</span>, warm_start=<span class="keyword">False</span>, presort=<span class="string">'auto'</span>)</div><div class="line"></div><div class="line">%time GBDT.fit(xTrain, yTrain)</div><div class="line"></div><div class="line">%time predTest = GBDT.predict(xTest)</div><div class="line">predResult = [chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> predTest]</div><div class="line">testlabels[<span class="string">"Class"</span>] = predResult</div><div class="line">testlabels.to_csv(<span class="string">"gbdt_result.csv"</span>,index = <span class="keyword">None</span>)</div></pre></td></tr></table></figure>
<pre><code>CPU times: user 91 Âµs, sys: 738 Âµs, total: 829 Âµs
Wall time: 2.93 ms
CPU times: user 40min 16s, sys: 52.3 s, total: 41min 9s
Wall time: 2h 55min 22s
CPU times: user 1.75 s, sys: 44.5 ms, total: 1.8 s
Wall time: 1.79 s
</code></pre><p>ä½¿ç”¨GBDTä»…å¾—åˆ°äº†0.31937çš„å‡†ç¡®ç‡ï¼Œå¯èƒ½æ˜¯æˆ‘çš„é»˜è®¤å‚æ•°æ²¡æœ‰è°ƒèŠ‚å¥½ï¼Œå…³é”®æ˜¯GBDTçš„è®­ç»ƒæ—¶é—´å¤ªé•¿ï¼Œè°ƒè¯•æˆæœ¬ä¹Ÿæ¯”è¾ƒé«˜</p>
<h3 id="u795E_u7ECF_u7F51_u7EDC"><a href="#u795E_u7ECF_u7F51_u7EDC" class="headerlink" title="ç¥ç»ç½‘ç»œ"></a>ç¥ç»ç½‘ç»œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">from</span> skimage.io <span class="keyword">import</span> imread</div><div class="line"><span class="keyword">from</span> lasagne <span class="keyword">import</span> layers</div><div class="line"><span class="keyword">from</span> lasagne.nonlinearities <span class="keyword">import</span> softmax</div><div class="line"><span class="keyword">from</span> nolearn.lasagne <span class="keyword">import</span> NeuralNet, BatchIterator</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Define functions</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_datax</span><span class="params">(typeData, labelsInfo, imageSize, path)</span>:</span></div><div class="line">    x = np.zeros((labelsInfo.shape[<span class="number">0</span>], imageSize))</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (index, idImage) <span class="keyword">in</span> enumerate(labelsInfo[<span class="string">'ID'</span>]):</div><div class="line">        <span class="comment"># use specially created 32 x 32 images</span></div><div class="line">        nameFile = <span class="string">'&#123;0&#125;/&#123;1&#125;Resized32/&#123;2&#125;.Bmp'</span>.format(path,</div><div class="line">                    typeData, idImage)</div><div class="line">        img = imread(nameFile, as_grey = <span class="keyword">True</span>)</div><div class="line"></div><div class="line">        x[index, :] = np.reshape(img, (<span class="number">1</span>, imageSize))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> x</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit_model</span><span class="params">(reshaped_train_x, y, image_width,</span></span></div><div class="line">                    image_height, reshaped_test_x):</div><div class="line">    net = NeuralNet(</div><div class="line">        layers = [</div><div class="line">            (<span class="string">'input'</span>, layers.InputLayer),</div><div class="line">            (<span class="string">'conv1'</span>, layers.Conv2DLayer),</div><div class="line">            (<span class="string">'pool1'</span>, layers.MaxPool2DLayer),</div><div class="line">            (<span class="string">'dropout1'</span>, layers.DropoutLayer),</div><div class="line">            (<span class="string">'conv2'</span>, layers.Conv2DLayer),</div><div class="line">            (<span class="string">'pool2'</span>, layers.MaxPool2DLayer),</div><div class="line">            (<span class="string">'dropout2'</span>, layers.DropoutLayer),</div><div class="line">            (<span class="string">'conv3'</span>, layers.Conv2DLayer),</div><div class="line">            (<span class="string">'hidden4'</span>, layers.DenseLayer),</div><div class="line">            (<span class="string">'output'</span>, layers.DenseLayer),</div><div class="line">        ],</div><div class="line">        input_shape = (<span class="keyword">None</span>, <span class="number">1</span>, <span class="number">32</span>, <span class="number">32</span>),</div><div class="line">        conv1_num_filters=<span class="number">32</span>, conv1_filter_size=(<span class="number">5</span>, <span class="number">5</span>),</div><div class="line">        pool1_pool_size=(<span class="number">2</span>, <span class="number">2</span>),</div><div class="line">        dropout1_p=<span class="number">0.2</span>,</div><div class="line">        conv2_num_filters=<span class="number">64</span>, conv2_filter_size=(<span class="number">5</span>, <span class="number">5</span>),</div><div class="line">        pool2_pool_size=(<span class="number">2</span>, <span class="number">2</span>),</div><div class="line">        dropout2_p=<span class="number">0.2</span>,</div><div class="line">        conv3_num_filters = <span class="number">128</span>, conv3_filter_size = (<span class="number">5</span>, <span class="number">5</span>),</div><div class="line">        hidden4_num_units=<span class="number">500</span>,</div><div class="line">        output_num_units = <span class="number">62</span>, output_nonlinearity = softmax,</div><div class="line"></div><div class="line">        update_learning_rate = <span class="number">0.01</span>,</div><div class="line">        update_momentum = <span class="number">0.9</span>,</div><div class="line"></div><div class="line">        batch_iterator_train = BatchIterator(batch_size = <span class="number">100</span>),</div><div class="line">        batch_iterator_test = BatchIterator(batch_size = <span class="number">100</span>),</div><div class="line"></div><div class="line">        use_label_encoder = <span class="keyword">True</span>,</div><div class="line">        regression = <span class="keyword">False</span>,</div><div class="line">        max_epochs = <span class="number">100</span>,</div><div class="line">        verbose = <span class="number">1</span>,</div><div class="line">    )</div><div class="line"></div><div class="line">    net.fit(reshaped_train_x, y)</div><div class="line">    prediction = net.predict(reshaped_test_x)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> prediction</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># é¢„å¤„ç†æ•°æ®ï¼Œé¦–å…ˆå°†å›¾ç‰‡ä¿å­˜ä¸º32*32çš„å°å›¾ç‰‡</span></div><div class="line">imageSize = <span class="number">1024</span> <span class="comment"># 32 x 32</span></div><div class="line">image_width = image_height = int(imageSize ** <span class="number">0.5</span>)</div><div class="line"></div><div class="line">labelsInfoTrain = pd.read_csv\</div><div class="line">            (<span class="string">'trainLabels.csv'</span>.format(path))</div><div class="line">labelsInfoTest = pd.read_csv\</div><div class="line">            (<span class="string">'sampleSubmission.csv'</span>.format(path))</div><div class="line"></div><div class="line"><span class="comment"># Load dataset</span></div><div class="line">nnxTrain = read_datax(<span class="string">'train'</span>, labelsInfoTrain, imageSize, <span class="string">'.'</span>)</div><div class="line">nnxTest = read_datax(<span class="string">'test'</span>, labelsInfoTest, imageSize, <span class="string">'.'</span>)</div><div class="line"></div><div class="line">nnyTrain = map(ord, labelsInfoTrain[<span class="string">'Class'</span>])</div><div class="line">nnyTrain = np.array(yTrain)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å½’ä¸€åŒ–æ•°æ®</span></div><div class="line">nnxTrain /= nnxTrain.std(axis = <span class="keyword">None</span>)</div><div class="line">nnxTrain -= nnxTrain.mean()</div><div class="line"></div><div class="line">nnxTest /= nnxTest.std(axis = <span class="keyword">None</span>)</div><div class="line">nnxTest -= nnxTest.mean()</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Reshape data</span></div><div class="line">train_x_reshaped = nnxTrain.reshape(nnxTrain.shape[<span class="number">0</span>], <span class="number">1</span>,</div><div class="line">                  image_height, image_width).astype(<span class="string">'float32'</span>)</div><div class="line">test_x_reshaped = nnxTest.reshape(nnxTest.shape[<span class="number">0</span>], <span class="number">1</span>,</div><div class="line">                  image_height, image_width).astype(<span class="string">'float32'</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># è¿›è¡Œè®­ç»ƒå’Œæµ‹è¯•</span></div><div class="line">predict = fit_model(train_x_reshaped, nnyTrain, image_width, image_height, test_x_reshaped)</div></pre></td></tr></table></figure>
<pre><code># Neural Network with 352586 learnable parameters

## Layer information

  #  name      size
---  --------  --------
  0  input     1x32x32
  1  conv1     32x28x28
  2  pool1     32x14x14
  3  dropout1  32x14x14
  4  conv2     64x10x10
  5  pool2     64x5x5
  6  dropout2  64x5x5
  7  conv3     128x1x1
  8  hidden4   500
  9  output    62

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.08201[0m     [32m4.01012[0m    1.01793      0.07254  16.55s
      2     [36m3.87688[0m     [32m3.84326[0m    1.00875      0.04836  17.72s
      3     [36m3.82788[0m     [32m3.79976[0m    1.00740      0.04914  16.58s
      4     [36m3.78741[0m     [32m3.78872[0m    0.99965      0.07254  16.14s
      5     [36m3.78030[0m     [32m3.78600[0m    0.99850      0.07254  16.37s
      6     [36m3.77679[0m     [32m3.78520[0m    0.99778      0.07254  16.56s
      7     [36m3.77487[0m     3.78537    0.99723      0.07254  16.30s
      8     [36m3.77411[0m     [32m3.78468[0m    0.99721      0.07254  16.51s
      9     [36m3.77257[0m     3.78518    0.99667      0.07254  15.92s
     10     [36m3.77202[0m     [32m3.78459[0m    0.99668      0.07254  16.55s
     11     [36m3.76948[0m     [32m3.78458[0m    0.99601      0.07254  16.25s
     12     [36m3.76882[0m     [32m3.78414[0m    0.99595      0.07254  16.31s
     13     [36m3.76717[0m     [32m3.78411[0m    0.99552      0.07254  15.70s
     14     [36m3.76606[0m     3.78469    0.99508      0.07254  16.04s
     15     [36m3.76419[0m     3.78671    0.99405      0.07176  15.70s
     16     [36m3.76277[0m     [32m3.78392[0m    0.99441      0.07176  16.05s
     17     [36m3.76014[0m     3.78821    0.99259      0.07176  15.71s
     18     3.78179     3.78606    0.99887      0.07254  16.11s
     19     3.76928     [32m3.78321[0m    0.99632      0.07254  15.75s
     20     3.76688     3.78358    0.99559      0.07254  16.05s
     21     3.76434     [32m3.78255[0m    0.99519      0.07254  17.36s
     22     3.76186     [32m3.78174[0m    0.99474      0.07254  18.12s
     23     [36m3.75829[0m     3.78184    0.99377      0.07878  17.90s
     24     [36m3.75370[0m     3.78545    0.99161      0.07488  18.19s
     25     [36m3.74749[0m     [32m3.77908[0m    0.99164      0.07098  17.81s
     26     [36m3.73650[0m     [32m3.77806[0m    0.98900      0.07020  18.08s
     27     [36m3.71592[0m     [32m3.77626[0m    0.98402      0.06474  18.03s
     28     [36m3.67805[0m     [32m3.74531[0m    0.98204      0.07176  18.04s
     29     [36m3.59550[0m     3.79802    0.94668      0.07566  18.12s
     30     [36m3.44086[0m     [32m3.35483[0m    1.02564      0.19111  18.06s
     31     [36m3.14160[0m     [32m3.00021[0m    1.04713      0.29251  17.41s
     32     [36m2.73389[0m     [32m2.89130[0m    0.94556      0.31903  16.19s
     33     [36m2.61587[0m     [32m2.53098[0m    1.03354      0.38144  15.73s
     34     [36m2.25316[0m     [32m2.26086[0m    0.99660      0.43994  16.14s
     35     [36m1.95499[0m     [32m2.03661[0m    0.95993      0.48206  15.76s
     36     [36m1.75483[0m     [32m1.94987[0m    0.89997      0.49610  16.01s
     37     [36m1.60276[0m     [32m1.78637[0m    0.89722      0.52106  15.60s
     38     [36m1.47862[0m     [32m1.73524[0m    0.85211      0.54524  15.98s
     39     [36m1.35049[0m     [32m1.65705[0m    0.81500      0.55694  15.62s
     40     [36m1.27458[0m     [32m1.65253[0m    0.77129      0.57254  16.01s
     41     [36m1.18548[0m     [32m1.60550[0m    0.73839      0.58112  15.61s
     42     [36m1.11862[0m     1.62259    0.68940      0.58268  16.51s
     43     [36m1.05698[0m     1.68044    0.62899      0.58112  16.24s
     44     [36m1.01350[0m     1.64642    0.61558      0.59126  16.50s
     45     [36m0.93587[0m     1.62059    0.57749      0.59906  15.81s
     46     [36m0.87893[0m     1.65983    0.52953      0.59984  16.54s
     47     [36m0.83695[0m     1.66309    0.50325      0.60452  16.42s
     48     1.72887     2.92194    0.59169      0.54446  16.31s
     49     3.85830     3.39520    1.13640      0.21373  15.84s
     50     2.26598     1.97743    1.14592      0.46724  18.41s
     51     2.11105     1.89927    1.11150      0.49298  18.02s
     52     1.66393     1.75705    0.94700      0.51794  17.99s
     53     1.48332     1.65795    0.89467      0.54212  17.94s
     54     1.38197     [32m1.60296[0m    0.86214      0.55928  17.73s
     55     1.28419     [32m1.56050[0m    0.82293      0.56318  17.94s
     56     1.21078     [32m1.54983[0m    0.78123      0.57176  17.70s
     57     1.13885     1.55330    0.73318      0.55616  17.93s
     58     1.10488     [32m1.53462[0m    0.71997      0.57956  17.71s
     59     1.03479     1.54234    0.67092      0.58502  17.70s
     60     0.98439     [32m1.52492[0m    0.64554      0.59984  17.95s
     61     0.93277     [32m1.49128[0m    0.62548      0.59204  17.67s
     62     1.03055     1.58280    0.65109      0.57878  18.01s
     63     0.89008     1.54904    0.57460      0.59750  17.69s
     64     0.83698     1.59463    0.52487      0.58346  17.92s
     65     [36m0.79801[0m     1.59534    0.50021      0.60452  17.80s
     66     [36m0.77752[0m     1.56702    0.49618      0.60842  17.91s
     67     [36m0.73901[0m     1.61821    0.45668      0.59594  17.81s
     68     [36m0.71108[0m     1.56703    0.45377      0.61154  17.98s
     69     [36m0.67279[0m     1.61497    0.41659      0.61154  17.81s
     70     [36m0.64651[0m     1.66452    0.38841      0.60530  17.97s
     71     [36m0.61597[0m     1.65828    0.37145      0.62012  17.84s
     72     [36m0.59188[0m     1.69796    0.34858      0.60296  17.92s
     73     [36m0.57862[0m     1.72392    0.33564      0.60686  17.73s
     74     [36m0.56451[0m     1.75449    0.32175      0.60062  17.56s
     75     [36m0.53835[0m     1.74351    0.30877      0.62090  17.77s
     76     [36m0.53288[0m     1.80642    0.29499      0.60842  18.08s
     77     [36m0.49975[0m     1.76941    0.28244      0.61700  17.76s
     78     [36m0.48489[0m     1.75930    0.27561      0.60998  17.92s
     79     [36m0.45688[0m     1.81943    0.25111      0.61622  17.78s
     80     0.46801     1.80187    0.25974      0.62480  17.96s
     81     [36m0.45527[0m     1.88136    0.24199      0.61310  17.84s
     82     [36m0.43178[0m     1.93961    0.22261      0.61622  18.56s
     83     [36m0.41726[0m     1.90341    0.21922      0.61856  16.52s
     84     [36m0.38590[0m     1.91029    0.20201      0.61778  15.59s
     85     [36m0.38510[0m     1.93524    0.19900      0.61778  16.00s
     86     [36m0.37565[0m     1.92514    0.19513      0.61466  15.56s
     87     [36m0.36222[0m     1.99870    0.18123      0.61544  15.88s
     88     0.38495     2.08839    0.18433      0.61466  15.55s
     89     [36m0.34101[0m     1.94872    0.17499      0.62559  15.97s
     90     [36m0.33575[0m     2.01506    0.16662      0.61856  15.63s
     91     [36m0.32353[0m     2.05956    0.15709      0.62090  16.03s
     92     [36m0.30422[0m     2.12548    0.14313      0.64041  15.66s
     93     [36m0.29631[0m     2.10645    0.14067      0.63495  16.02s
     94     0.32050     2.11861    0.15128      0.62168  15.73s
     95     0.30140     2.14516    0.14050      0.62871  15.99s
     96     [36m0.28195[0m     2.09292    0.13472      0.63339  15.67s
     97     0.30323     2.20744    0.13737      0.62246  16.07s
     98     [36m0.27107[0m     2.15645    0.12570      0.63729  16.32s
     99     0.27947     2.22565    0.12557      0.62637  16.51s
    100     [36m0.26500[0m     2.22825    0.11893      0.64431  16.52s
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ä¿å­˜ç»“æœ</span></div><div class="line">yTest = map(chr, predict)</div><div class="line">labelsInfoTest[<span class="string">'Class'</span>] = yTest</div><div class="line">labelsInfoTest.to_csv(<span class="string">'nnresult.csv'</span>.format(path), index = <span class="keyword">False</span>)</div></pre></td></tr></table></figure>
<p>æäº¤kaggleä¹‹åçš„å‡†ç¡®ç‡ï¼š0.64562</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.notehub.cn/2016/08/21/algo/kaggle/image_recognize/" data-id="cj3uvlzqr004fbms9z7vrirfi" class="article-share-link">åˆ†äº«åˆ°</a>
      
        <a href="http://www.notehub.cn/2016/08/21/algo/kaggle/image_recognize/#ds-thread" class="article-comment-link">è¯„è®º</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kaggle/">kaggle</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/4/">&laquo; ä¸Šä¸€é¡µ</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/6/">ä¸‹ä¸€é¡µ &raquo;</a>
      </nav>
    
</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul id="recent-post" class="">
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2017/06/12/dev/collect/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/dev/">dev</a></p>
              <p class="item-title"><a href="/2017/06/12/dev/collect/" class="title">æ”¶é›†</a></p>
              <p class="item-date"><time datetime="2017-06-12T06:19:56.000Z" itemprop="datePublished">2017-06-12</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2017/06/12/dev/web/ajax_upload/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/web/">web</a></p>
              <p class="item-title"><a href="/2017/06/12/dev/web/ajax_upload/" class="title">Ajax æ–‡ä»¶ä¸Šä¼ </a></p>
              <p class="item-date"><time datetime="2017-06-12T05:19:56.000Z" itemprop="datePublished">2017-06-12</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/12/21/dev/go/go_file/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/dev/">dev</a></p>
              <p class="item-title"><a href="/2016/12/21/dev/go/go_file/" class="title">Goæ–‡ä»¶æ“ä½œå¤§å…¨</a></p>
              <p class="item-date"><time datetime="2016-12-21T07:19:56.000Z" itemprop="datePublished">2016-12-21</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/12/16/dev/encode/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/dev/">dev</a></p>
              <p class="item-title"><a href="/2016/12/16/dev/encode/" class="title">Excelå¯¼å…¥CSVæ–‡ä»¶ä¸­æ–‡ä¹±ç </a></p>
              <p class="item-date"><time datetime="2016-12-16T02:19:56.000Z" itemprop="datePublished">2016-12-16</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/12/16/dev/python/python_extra/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/dev/">dev</a></p>
              <p class="item-title"><a href="/2016/12/16/dev/python/python_extra/" class="title">Python snippets</a></p>
              <p class="item-date"><time datetime="2016-12-16T02:19:56.000Z" itemprop="datePublished">2016-12-16</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">åˆ†ç±»</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hash/">Hash</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hive/">Hive</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Photo/">Photo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zabbix/">Zabbix</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ads/">ads</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/c/">c++</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/dev/">dev</a><span class="category-list-count">39</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/github/">github</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/internet/">internet</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kaggle/">kaggle</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/machine-learning/">machine learning</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/sklearn/">sklearn</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/system/">system</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/travel/">travel</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">å…­æœˆ 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">åäºŒæœˆ 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">åä¸€æœˆ 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">åæœˆ 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">ä¹æœˆ 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">å…«æœˆ 2016</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">äº”æœˆ 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">ä¸‰æœˆ 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">äºŒæœˆ 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">ä¸€æœˆ 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">åäºŒæœˆ 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">åä¸€æœˆ 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">åæœˆ 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">ä¹æœˆ 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">å…­æœˆ 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">äº”æœˆ 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">å››æœˆ 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">ä¸‰æœˆ 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">äºŒæœˆ 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">ä¸€æœˆ 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">åäºŒæœˆ 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">åä¸€æœˆ 2014</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">åæœˆ 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">å…­æœˆ 2014</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">åä¸€æœˆ 2013</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾äº‘</h3>
    <div class="widget tagcloud">
      <a href="/tags/Apache/" style="font-size: 10px;">Apache</a> <a href="/tags/Bandits/" style="font-size: 12.5px;">Bandits</a> <a href="/tags/Elasticsearch-docker/" style="font-size: 10px;">Elasticsearch, docker</a> <a href="/tags/FlatBuffers/" style="font-size: 10px;">FlatBuffers</a> <a href="/tags/Google/" style="font-size: 10px;">Google</a> <a href="/tags/Granger-causality/" style="font-size: 10px;">Granger causality</a> <a href="/tags/GridSearchCV/" style="font-size: 10px;">GridSearchCV</a> <a href="/tags/HTTPS/" style="font-size: 10px;">HTTPS</a> <a href="/tags/Jquery/" style="font-size: 10px;">Jquery</a> <a href="/tags/MapReduce/" style="font-size: 10px;">MapReduce</a> <a href="/tags/Mock/" style="font-size: 10px;">Mock</a> <a href="/tags/Monument-Vallay/" style="font-size: 10px;">Monument Vallay</a> <a href="/tags/Mysql/" style="font-size: 12.5px;">Mysql</a> <a href="/tags/PPTP-vpn/" style="font-size: 12.5px;">PPTP, vpn</a> <a href="/tags/Photoshop/" style="font-size: 10px;">Photoshop</a> <a href="/tags/Pipeline/" style="font-size: 10px;">Pipeline</a> <a href="/tags/Shadowsocks/" style="font-size: 10px;">Shadowsocks</a> <a href="/tags/ad/" style="font-size: 10px;">ad</a> <a href="/tags/apache/" style="font-size: 10px;">apache</a> <a href="/tags/blade/" style="font-size: 10px;">blade</a> <a href="/tags/crontab/" style="font-size: 10px;">crontab</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/elasticsearch/" style="font-size: 12.5px;">elasticsearch</a> <a href="/tags/font/" style="font-size: 10px;">font</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/go/" style="font-size: 17.5px;">go</a> <a href="/tags/hashmap/" style="font-size: 10px;">hashmap</a> <a href="/tags/kaggle/" style="font-size: 20px;">kaggle</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/linux-ldd-ä¾èµ–å…³ç³»/" style="font-size: 10px;">linux, ldd, ä¾èµ–å…³ç³»</a> <a href="/tags/lucene/" style="font-size: 10px;">lucene</a> <a href="/tags/nio/" style="font-size: 10px;">nio</a> <a href="/tags/pagerank/" style="font-size: 10px;">pagerank</a> <a href="/tags/photo/" style="font-size: 10px;">photo</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/swift-llvm/" style="font-size: 10px;">swift, llvm</a> <a href="/tags/å‰ç«¯/" style="font-size: 10px;">å‰ç«¯</a> <a href="/tags/å¹¿å‘Š/" style="font-size: 12.5px;">å¹¿å‘Š</a> <a href="/tags/å¼€æºï¼Œè®¸å¯/" style="font-size: 10px;">å¼€æºï¼Œè®¸å¯</a> <a href="/tags/æ¾³é—¨/" style="font-size: 10px;">æ¾³é—¨</a> <a href="/tags/ç›‘æ§ï¼Œzabbix/" style="font-size: 10px;">ç›‘æ§ï¼Œzabbix</a> <a href="/tags/è´å¶æ–¯/" style="font-size: 10px;">è´å¶æ–¯</a>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Li Jingpeng<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script type="text/javascript">
  var duoshuoQuery = {short_name:"lijingpeng"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>


<script src="//ajax.css.network/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>