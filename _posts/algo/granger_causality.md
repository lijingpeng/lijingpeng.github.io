date: 2015-10-27 19：20：00
title: Granger causality
tags: Granger causality
category: machine learning
---


### Granger causality
---

如果一个变量X无助于预测另一个变量Y，则说X不是Y的原因；相反，若X是Y的原因，则必须满足两个条件：第一，X应该有助于预测Y，即在Y关于Y的过去值的回归中，添加X的过去值作为独立变量应当显著地增加回归的解释能力；第二，Y不应当有助于预测X，其原因是，如果X有助于预测Y，Y也有助于预测X，则很可能存在一个或几个其他变量，它们既是引起X变化的原因，也是引起Y变化的原因。

### Granger因果关系检验 
---

![](/images/gc1.png)
![](/images/gc2.png)
![](/images/gc3.png)


### 关于鸡生蛋还是蛋生鸡
---

鸡生蛋还是蛋生鸡？对于原因与结果的区分，自古以来是个难题。1926年，挪威经济学家、第一届（1969年）诺贝尔经济学奖得主弗瑞希（R . Frisch）仿照“生物计量学”（Biometrics）一词提出了“计量经济学”或“经济计量学”（Econometrics）之名。有趣的是，两位经济学家Walter N. Thurman和Mark E. Fisher又将计量经济学的方法用于讨论生物学领域的问题（当然也可以算是经济问题，因为研究结果发表杂经济学杂志上），探讨了这个“鸡与蛋”的关系问题。见“Chicken，eggs，and causality，or which came first?”, American Journal of Agricultural Economics, pp237-238, May 1988”。

他们用1930-1983期间美国鸡蛋产量和美国同期鸡产量的时间序列数据，建立滞后回归模型（1-4年），然后做格兰杰因果关系检验。结果能够拒绝鸡蛋不是鸡出现原因的原假设，同时不能拒绝鸡不是鸡蛋出现的原因的原假设（只有在检验出单向因果关系后，检验才是有效的）。也就是是说鸡生蛋的假设被拒绝，而蛋生鸡的假设成立，因此，蛋为因，鸡为果。因此，他们得出先有蛋的结论。他们建议作其他诸如“最后笑者笑得最好”（He who laughs last laughs best）、“骄傲是失败之母”（Pride goeth before destruction, and an haughty spirit before a fall）之类的格兰杰因果检验。

```R
library(lmtest) 

data(ChickEgg)
grangertest(egg ~ chicken, order = 4, data = ChickEgg)
grangertest(chicken ~ egg, order = 4, data = ChickEgg)
```

结果:
Granger causality test
Model 1: egg ~ Lags(egg, 1:4) + Lags(chicken, 1:4)
Model 2: egg ~ Lags(egg, 1:4)
  Res.Df Df      F Pr(>F)
1     41                 
2     45 -4 0.3929 0.8125
我们的假设是『鸡不是蛋的原因』， egg ~ Lags(egg, 1:4) + Lags(chicken, 1:4)， 拒绝该假设犯错的概率是0.8125， 因此我们不可以拒绝该假设， 也就是『鸡不是蛋的原因』成立

Granger causality test
Model 1: chicken ~ Lags(chicken, 1:4) + Lags(egg, 1:4)
Model 2: chicken ~ Lags(chicken, 1:4)
  Res.Df Df      F   Pr(>F)   
1     41                      
2     45 -4 4.2568 0.005671 **

我们的假设是『蛋不是鸡的原因』， chicken ~ Lags(chicken, 1:4) + Lags(egg, 1:4)， 拒绝该假设犯错的概率是0.005671， 因此我们可以拒绝该假设， 也就是蛋->鸡是成立的


他们所使用的分析变量之间的因果的办法，即格兰杰因果关系检验。该检验方法为2003年诺贝尔经济学奖得主克莱夫·格兰杰（Clive W. J. Granger）所开创。从统计的角度，因果关系是通过概率或者分布函数的角度体现出来的：在宇宙中所有其它事件的发生情况固定不变的条件下，如果一个事件A的发生与不发生对于另一个事件B的发生的概率（如果通过事件定义了随机变量那么也可以说分布函数）有影响，并且这两个事件在时间上又先后顺序（A前B后），那么我们便可以说A是B的原因。Granger从预测的角度给出了因果性的一个定义：如果x有助于预测(解释)y，则x是y的Granger原因。将x的信息从信息集中去除不会改变对y的最优预测,则x不是y的granger原因。相反，会改变预测，则x是y的Granger原因，即将过去的x包含在信息集中可提高对y的预测。格兰杰因果检验只是数据上的因果关系不代表实际的因果关系。

格兰杰因果关系检验的基本思路是，在两个变量x和y的系统中，若y的现在值用x和y的过去值预测要好于单独用y预测，那么，称x是y的原因；若用x的现在值和x、y的过去值去预测y比只用x和y去预测要好，那么，称x是y的瞬时原因。反之反是。换言之，如果x的变化引起y的变化，则x的变化应当发生在y的变化之前。特别地，说“x是引起y变化的原因”，则必须满足两个条件：一是x应该有助于预测y，即在y关于y的过去值的回归分析中，添加x的过去值作为独立变量应当显著地增加回归的解释能力；二是y不应当有助于预测x，其原因是如果x有助于预测y，y也有助于预测x，则很可能存在一个或几个其它的变量，它们既是引起x变化的原因，也是引起y变化的原因。

进行格兰杰因果关系检验的一个前提条件是时间序列必须具有平稳性，否则可能会出现虚假回归问题。因此在进行格兰杰因果关系检验之前首先应对各指标时间序列的平稳性进行单位根检验(unit  root  test)。常用增广的迪基—富勒检验(ADF检验)来分别对各指标序列的平稳性进行单位根检验。格兰杰检验的特点决定了它只能适用于时间序列数据模型的因果性检验，无法检验只有横截面数据时变量间的因果性。因此，在使用这种方法时，务必检查前提条件，使其尽量能够满足。

时间序列的稳定性是指时间序列的方差、协方差、均值不受时间t的影响。平稳性就是要求经由样本时间序列所得到的拟合曲线在未来的一段期间内仍能顺着现有的形态“惯性”地延续下去；如果数据非平稳，则说明样本拟合曲线的形态不具有“惯性”延续的特点，也就是基于未来将要获得的样本时间序列所拟合出来的曲线将迥异于当前的样本拟合曲线。

由于格兰杰天才地利用了条件概率来定义因果关系，所以他的方法显得既实用又有效，这是个令许多人甚至哲学家都佩服的思维上的突破。但是格兰杰因果关系检验的结论只是统计意义上的因果性，而不一定是真正的因果关系。虽然可以作为真正的因果关系的一种支持，但不能作为肯定或否定因果关系的最终根据。也许，鸡和蛋之间没有必要讨论谁先谁后的问题，因为在足够长的时间里，不存在单向的因果关系，或者说只是存在互为因果关系。运用统计工具来解释经济变量之间的关系，仍有很多的漏洞，存在很多逻辑上的问题。“鸡生蛋还是蛋生鸡”的命题告诉我们，在许多情况下，探讨因果关系是没有意义的。

真正的因果关系，还是要立足于理论模型的思考。统计方法并非万能的，评判一个对象，往往需要多种角度的观察。正所谓“兼听则明，偏听则暗”。诚然真相永远只有一个，但是也要靠科学的探索方法。当然，我们也不能因噎废食，全盘否定计量统计的意义。即使格兰杰因果关系不等于实际因果关系，也并不妨碍其参考价值。因为统计意义上的因果关系也是有意义的，对于经济预测等仍然能起很大的作用。
